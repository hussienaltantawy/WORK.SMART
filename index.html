<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WORK SMART</title>
    
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js">
// ===== Date Converter Enhancements =====
let dateDebounceTimer = null;

function autoConvertDate() {
    clearTimeout(dateDebounceTimer);
    dateDebounceTimer = setTimeout(() => {
        convertDateSmart();
    }, 400);
}

function convertDateSmart() {
    const inputEl = document.getElementById('dateInput');
    const errorEl = document.getElementById('dateError');
    if (!inputEl) return;

    const value = inputEl.value.trim();
    if (!value) {
        if (errorEl) errorEl.textContent = '';
        return;
    }

    let year, month, day;

    // YYYY-MM-DD
    if (/^\d{4}-\d{2}-\d{2}$/.test(value)) {
        [year, month, day] = value.split('-').map(Number);
    }
    // DD/MM/YYYY
    else if (/^\d{2}\/\d{2}\/\d{4}$/.test(value)) {
        [day, month, year] = value.split('/').map(Number);
    } else {
        showDateError('Invalid format. Use DD/MM/YYYY or YYYY-MM-DD');
        return;
    }

    const date = new Date(year, month - 1, day);

    if (
        date.getFullYear() !== year ||
        date.getMonth() !== month - 1 ||
        date.getDate() !== day
    ) {
        showDateError('Invalid date');
        return;
    }

    clearDateError();
    convertDate(date);
}

function showDateError(msg) {
    let errorEl = document.getElementById('dateError');
    if (!errorEl) {
        errorEl = document.createElement('div');
        errorEl.id = 'dateError';
        errorEl.style.color = '#e74c3c';
        errorEl.style.marginTop = '6px';
        document.getElementById('dateInput').after(errorEl);
    }
    errorEl.textContent = msg;
}

function clearDateError() {
    const errorEl = document.getElementById('dateError');
    if (errorEl) errorEl.textContent = '';
}
// ===== END Date Converter Enhancements =====

</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js">
// ===== Date Converter Enhancements =====
let dateDebounceTimer = null;

function autoConvertDate() {
    clearTimeout(dateDebounceTimer);
    dateDebounceTimer = setTimeout(() => {
        convertDateSmart();
    }, 400);
}

function convertDateSmart() {
    const inputEl = document.getElementById('dateInput');
    const errorEl = document.getElementById('dateError');
    if (!inputEl) return;

    const value = inputEl.value.trim();
    if (!value) {
        if (errorEl) errorEl.textContent = '';
        return;
    }

    let year, month, day;

    // YYYY-MM-DD
    if (/^\d{4}-\d{2}-\d{2}$/.test(value)) {
        [year, month, day] = value.split('-').map(Number);
    }
    // DD/MM/YYYY
    else if (/^\d{2}\/\d{2}\/\d{4}$/.test(value)) {
        [day, month, year] = value.split('/').map(Number);
    } else {
        showDateError('Invalid format. Use DD/MM/YYYY or YYYY-MM-DD');
        return;
    }

    const date = new Date(year, month - 1, day);

    if (
        date.getFullYear() !== year ||
        date.getMonth() !== month - 1 ||
        date.getDate() !== day
    ) {
        showDateError('Invalid date');
        return;
    }

    clearDateError();
    convertDate(date);
}

function showDateError(msg) {
    let errorEl = document.getElementById('dateError');
    if (!errorEl) {
        errorEl = document.createElement('div');
        errorEl.id = 'dateError';
        errorEl.style.color = '#e74c3c';
        errorEl.style.marginTop = '6px';
        document.getElementById('dateInput').after(errorEl);
    }
    errorEl.textContent = msg;
}

function clearDateError() {
    const errorEl = document.getElementById('dateError');
    if (errorEl) errorEl.textContent = '';
}
// ===== END Date Converter Enhancements =====

</script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js">
// ===== Date Converter Enhancements =====
let dateDebounceTimer = null;

function autoConvertDate() {
    clearTimeout(dateDebounceTimer);
    dateDebounceTimer = setTimeout(() => {
        convertDateSmart();
    }, 400);
}

function convertDateSmart() {
    const inputEl = document.getElementById('dateInput');
    const errorEl = document.getElementById('dateError');
    if (!inputEl) return;

    const value = inputEl.value.trim();
    if (!value) {
        if (errorEl) errorEl.textContent = '';
        return;
    }

    let year, month, day;

    // YYYY-MM-DD
    if (/^\d{4}-\d{2}-\d{2}$/.test(value)) {
        [year, month, day] = value.split('-').map(Number);
    }
    // DD/MM/YYYY
    else if (/^\d{2}\/\d{2}\/\d{4}$/.test(value)) {
        [day, month, year] = value.split('/').map(Number);
    } else {
        showDateError('Invalid format. Use DD/MM/YYYY or YYYY-MM-DD');
        return;
    }

    const date = new Date(year, month - 1, day);

    if (
        date.getFullYear() !== year ||
        date.getMonth() !== month - 1 ||
        date.getDate() !== day
    ) {
        showDateError('Invalid date');
        return;
    }

    clearDateError();
    convertDate(date);
}

function showDateError(msg) {
    let errorEl = document.getElementById('dateError');
    if (!errorEl) {
        errorEl = document.createElement('div');
        errorEl.id = 'dateError';
        errorEl.style.color = '#e74c3c';
        errorEl.style.marginTop = '6px';
        document.getElementById('dateInput').after(errorEl);
    }
    errorEl.textContent = msg;
}

function clearDateError() {
    const errorEl = document.getElementById('dateError');
    if (errorEl) errorEl.textContent = '';
}
// ===== END Date Converter Enhancements =====

</script>
    <script src="https://cdn.jsdelivr.net/npm/moment-hijri@2.1.2/moment-hijri.min.js">
// ===== Date Converter Enhancements =====
let dateDebounceTimer = null;

function autoConvertDate() {
    clearTimeout(dateDebounceTimer);
    dateDebounceTimer = setTimeout(() => {
        convertDateSmart();
    }, 400);
}

function convertDateSmart() {
    const inputEl = document.getElementById('dateInput');
    const errorEl = document.getElementById('dateError');
    if (!inputEl) return;

    const value = inputEl.value.trim();
    if (!value) {
        if (errorEl) errorEl.textContent = '';
        return;
    }

    let year, month, day;

    // YYYY-MM-DD
    if (/^\d{4}-\d{2}-\d{2}$/.test(value)) {
        [year, month, day] = value.split('-').map(Number);
    }
    // DD/MM/YYYY
    else if (/^\d{2}\/\d{2}\/\d{4}$/.test(value)) {
        [day, month, year] = value.split('/').map(Number);
    } else {
        showDateError('Invalid format. Use DD/MM/YYYY or YYYY-MM-DD');
        return;
    }

    const date = new Date(year, month - 1, day);

    if (
        date.getFullYear() !== year ||
        date.getMonth() !== month - 1 ||
        date.getDate() !== day
    ) {
        showDateError('Invalid date');
        return;
    }

    clearDateError();
    convertDate(date);
}

function showDateError(msg) {
    let errorEl = document.getElementById('dateError');
    if (!errorEl) {
        errorEl = document.createElement('div');
        errorEl.id = 'dateError';
        errorEl.style.color = '#e74c3c';
        errorEl.style.marginTop = '6px';
        document.getElementById('dateInput').after(errorEl);
    }
    errorEl.textContent = msg;
}

function clearDateError() {
    const errorEl = document.getElementById('dateError');
    if (errorEl) errorEl.textContent = '';
}
// ===== END Date Converter Enhancements =====

</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js">
// ===== Date Converter Enhancements =====
let dateDebounceTimer = null;

function autoConvertDate() {
    clearTimeout(dateDebounceTimer);
    dateDebounceTimer = setTimeout(() => {
        convertDateSmart();
    }, 400);
}

function convertDateSmart() {
    const inputEl = document.getElementById('dateInput');
    const errorEl = document.getElementById('dateError');
    if (!inputEl) return;

    const value = inputEl.value.trim();
    if (!value) {
        if (errorEl) errorEl.textContent = '';
        return;
    }

    let year, month, day;

    // YYYY-MM-DD
    if (/^\d{4}-\d{2}-\d{2}$/.test(value)) {
        [year, month, day] = value.split('-').map(Number);
    }
    // DD/MM/YYYY
    else if (/^\d{2}\/\d{2}\/\d{4}$/.test(value)) {
        [day, month, year] = value.split('/').map(Number);
    } else {
        showDateError('Invalid format. Use DD/MM/YYYY or YYYY-MM-DD');
        return;
    }

    const date = new Date(year, month - 1, day);

    if (
        date.getFullYear() !== year ||
        date.getMonth() !== month - 1 ||
        date.getDate() !== day
    ) {
        showDateError('Invalid date');
        return;
    }

    clearDateError();
    convertDate(date);
}

function showDateError(msg) {
    let errorEl = document.getElementById('dateError');
    if (!errorEl) {
        errorEl = document.createElement('div');
        errorEl.id = 'dateError';
        errorEl.style.color = '#e74c3c';
        errorEl.style.marginTop = '6px';
        document.getElementById('dateInput').after(errorEl);
    }
    errorEl.textContent = msg;
}

function clearDateError() {
    const errorEl = document.getElementById('dateError');
    if (errorEl) errorEl.textContent = '';
}
// ===== END Date Converter Enhancements =====

</script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Poppins:wght@400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #1e3a8a;
            --secondary: #1e40af;
            --accent: #3b82f6;
            --dark: #0f172a;
            --light: #f8fafc;
            --success: #10b981;
            --error: #ef4444;
            --weekend: #dc2626;
            --border: #e2e8f0;
        }
        
        html { scroll-behavior: smooth; }

        body {
            font-family: 'Poppins', sans-serif;
            background: url('bg4.jpg') center center / cover no-repeat fixed;
            min-height: 100vh;
            padding: 10px 15px;
        }
        
        .container {
            max-width: 1250px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        /* Make all tool boxes same width */
        .tool-box {
            width: 100%;
            max-width: 1150px;
            margin-left: auto;
            margin-right: auto;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Header */
        header {
            text-align: center;
            padding: 40px 20px;
            margin-bottom: 20px;
            background: transparent;
            border-radius: 30px;
            position: relative;
            overflow: hidden;
            box-shadow: none;
        }
        
        header::before {
            display: none;
        }
        
        @keyframes moveBackground {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }
        
        header::after {
            display: none;
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        /* Navigation Menu */
        .nav-menu {
            background: white;
            border-radius: 15px;
            padding: 10px 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }
        
        
.nav-links {
    display: flex;
    gap: 12px;
    align-items: center;
    flex-wrap: wrap;
    justify-content: center;
}

.nav-menu {
    width: 100%;
    max-width: 1150px;
    margin: 0 auto 30px auto;
    text-align: center;
}

.nav-links {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .nav-link {
            padding: 10px 18px;
            background: linear-gradient(135deg, #1e3a8a, #1e40af);
            border: none;
            border-radius: 25px;
            text-decoration: none;
            color: white;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            white-space: nowrap;
            box-shadow: 0 2px 8px rgba(30, 58, 138, 0.3);
        }
        
        .nav-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(30, 58, 138, 0.5);
            background: linear-gradient(135deg, #2563eb, #3b82f6);
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        h1 {
            font-size: 3rem;
            font-weight: 900;
            color: white;
            text-transform: uppercase;
            letter-spacing: 8px;
            text-shadow: 
                0 4px 20px rgba(0, 0, 0, 0.5),
                0 0 40px rgba(255, 255, 255, 0.3);
            margin-bottom: 10px;
            animation: glow 2s ease-in-out infinite;
        }
        
        @keyframes glow {
            0%, 100% { text-shadow: 0 4px 20px rgba(0, 0, 0, 0.5), 0 0 40px rgba(255, 255, 255, 0.3); }
            50% { text-shadow: 0 4px 30px rgba(0, 0, 0, 0.5), 0 0 60px rgba(255, 255, 255, 0.5); }
        }
        
        .signature {
            font-family: 'Brush Script MT', 'Segoe Script', cursive;
            font-size: 1.5rem;
            color: rgba(255, 255, 255, 0.9);
            font-style: italic;
            margin-top: 5px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        /* Tool Box */
        .tool-box {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            
        }
        
        /* Tool boxes in grids should also be uniform */
        .tools-grid > .tool-box,
        .task-notes-grid > .tool-box {
            
        }
        
        /* Side by Side Layout */
        .tools-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
            width: 100%;
            max-width: 1150px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .task-notes-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
            width: 100%;
            max-width: 1150px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Navigation menu centering */
        .nav-menu {
            width: 100%;
            max-width: 1150px;
            margin-left: auto;
            margin-right: auto;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Header centering */
        header {
            width: 100%;
            max-width: 1150px;
            margin-left: auto;
            margin-right: auto;
            margin-left: auto;
            margin-right: auto;
        }
        
        @media (max-width: 968px) {
            .tools-grid {
                grid-template-columns: 1fr;
            }
            
            .task-notes-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .tool-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
            font-family: 'Poppins', 'Cairo', sans-serif;
        }
        
        /* Name Translator */
        .translator-grid {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: start;
            margin-bottom: 20px;
        }
        
        .input-section {
            background: #f8fafc;
            border-radius: 12px;
            padding: 18px;
            border: 1px solid var(--border);
        }
        
        .section-label {
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        textarea {
            width: 100%;
            min-height: 80px;
            max-height: 400px;
            border: 1px solid #e2e8f0;
            background: white;
            border-radius: 8px;
            padding: 12px;
            font-size: 0.95rem;
            font-family: 'Cairo', 'Poppins', sans-serif;
            resize: vertical;
            outline: none;
        }
        
        textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }
        
        .arabic-input {
            direction: rtl;
            text-align: right;
            font-family: 'Cairo', sans-serif;
        }
        
        .english-output {
            direction: ltr;
            text-align: left;
            background: #f1f5f9;
            color: var(--dark);
            font-weight: 600;
        }
        
        .swap-btn {
            align-self: center;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: white;
            font-size: 1.3rem;
            transition: all 0.3s ease;
        }
        
        .swap-btn:hover {
            transform: rotate(180deg) scale(1.1);
        }
        
        /* Buttons */
        .btn-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: nowrap;
            overflow-x: auto;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

/* OCR Mode Buttons - Professional Styling */
.ocr-mode-btn {
    padding: 8px 16px;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    background: white;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: 600;
    transition: all 0.2s ease;
}

.ocr-mode-btn:hover {
    background: #f8fafc;
    border-color: var(--primary);
}

.ocr-mode-active {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border-color: var(--primary);
}

        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #64748b, #475569);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        
        /* Date Converter */
        .date-converter-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 768px) {
            .date-converter-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .date-section {
            background: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid var(--border);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
        }
        
        input[type="date"],
        input[type="number"],
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Poppins', 'Cairo', sans-serif;
            outline: none;
            transition: border-color 0.3s;
        }
        
        input:focus,
        select:focus {
            border-color: var(--accent);
        }
        
        .hijri-inputs {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 10px;
        }
        
        .result-box {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
            border-radius: 15px;
            padding: 10px 15px;
            margin-top: 20px;
            border: 2px solid var(--border);
            display: none;
        }
        
        .result-box.weekend {
            background: linear-gradient(135deg, var(--weekend), #b91c1c);
            color: white;
        }
        
        .result-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
        }
        
        .result-box.weekend .result-label {
            color: white;
        }
        
        .result-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .result-box.weekend .result-value {
            color: white;
        }
        
        .result-box .result-value {
            direction: rtl;
            text-align: right;
        }
        
        .weekend-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 700;
            margin-left: 10px;
        }
        
        /* Calculator Styles */
        .calc-grid {
            display: grid;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .calc-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        /* Updated Result Item with Inline Copy Button */
        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: white;
            border-radius: 10px;
            margin-bottom: 10px;
            gap: 10px;
        }
        
        .result-item:last-child {
            margin-bottom: 0;
        }
        
        .result-label {
            font-weight: 600;
            color: var(--dark);
            font-size: 1rem;
        }
        
        .result-value-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .result-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .copy-value-btn {
            padding: 6px 12px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }
        
        .copy-value-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        /* Description Box */
        .description-box {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-radius: 15px;
            padding: 10px 15px;
            margin-top: 20px;
            border: 2px solid #fbbf24;
            direction: rtl;
            text-align: right;
        }
        
        .description-box h4 {
            color: #92400e;
            margin-bottom: 10px;
            font-family: 'Cairo', sans-serif;
        }
        
        .description-box p {
            color: #78350f;
            line-height: 1.6;
            font-family: 'Cairo', sans-serif;
        }
        
        /* Flat Rate Calculator */
        .flat-rate-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 968px) {
            .flat-rate-container {
                grid-template-columns: 1fr;
            }
        }
        
        .flat-section {
            background: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid var(--border);
        }
        
        .flat-section h4 {
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.1rem;
        }
        
        .flat-input-grid {
            display: grid;
            grid-template-columns: 80px 1fr 1fr;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .flat-result {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 15px;
            padding: 10px 15px;
            margin-top: 20px;
            text-align: center;
            position: relative;
        }
        
        .flat-result-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: white;
            margin-bottom: 8px;
        }
        
        .flat-result-value {
            font-size: 2rem;
            font-weight: 900;
            color: white;
        }
        
        .copy-result-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            border-radius: 10px;
            color: white;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .copy-result-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        /* Day Items */
        .day-item {
            display: grid;
            grid-template-columns: 2fr 1fr auto;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }
        
        .day-select,
        .day-price {
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            outline: none;
        }
        
        .remove-day-btn {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .remove-day-btn:hover {
            transform: scale(1.1);
        }
        
        /* Nights Calculator */
        .nights-result {
            background: linear-gradient(135deg, #1e3a8a, #1e40af);
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
            text-align: center;
        }
        
        .nights-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }
        
        .nights-label {
            font-size: 0.95rem;
            font-weight: 600;
            color: white;
            font-family: 'Cairo', 'Poppins', sans-serif;
            background: rgba(255, 255, 255, 0.15);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            flex: 1;
        }
        
        .nights-value {
            font-size: 2rem;
            font-weight: 800;
            color: white;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            display: block;
            margin-top: 8px;
        }
        
        .nights-breakdown {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .nights-breakdown.weekend {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            border: 2px solid #991b1b;
        }
        
        .breakdown-label {
            display: block;
            font-size: 0.9rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 8px;
        }
        
        .breakdown-value {
            display: block;
            font-size: 2rem;
            font-weight: 800;
            color: white;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        input[type="date"] {
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Poppins', sans-serif;
            outline: none;
            width: 100%;
            cursor: pointer;
        }
        
        input[type="date"]:focus {
            border-color: var(--accent);
        }
        
        /* Business Calculator */
        .business-result {
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
            text-align: center;
        }
        
        .business-display {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }
        
        .business-label {
            font-size: 1.1rem;
            font-weight: 600;
            color: white;
            font-family: 'Cairo', 'Poppins', sans-serif;
        }
        
        .business-value {
            font-size: 3rem;
            font-weight: 900;
            color: white;
            text-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        
        .business-value.negative {
            color: #fecaca;
        }
        
        .business-value.positive {
            color: white;
        }
        
        /* Rooming List */
        .rooming-header,
        .rooming-row {
            display: grid;
            grid-template-columns: 1.8fr 0.8fr 1.1fr 1.1fr 1.1fr 50px;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .rooming-header {
            font-weight: 700;
            color: var(--primary);
            padding: 15px;
            background: #f8fafc;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .rooming-row input,
        .rooming-row select {
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            outline: none;
        }
        
        .guest-name {
            font-family: 'Cairo', 'Poppins', sans-serif;
        }
        
        .rooming-preview,
        .extensions-preview {
            display: none;
            background: #f8fafc;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            border: 2px solid var(--border);
        }
        
        .rooming-table,
        .extensions-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .rooming-table th,
        .rooming-table td,
        .extensions-table th,
        .extensions-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        
        .rooming-table th,
        .extensions-table th {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            font-weight: 700;
            text-transform: uppercase;
        }
        
        .rooming-table tr:last-child td,
        .extensions-table tr:last-child td {
            border-bottom: none;
        }
        
        /* Extensions Maker */
        .extensions-header,
        .extensions-row {
            display: grid;
            grid-template-columns: 1.8fr 1.1fr 1.1fr 1.1fr 1.1fr 50px;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .extensions-header {
            font-weight: 700;
            color: var(--primary);
            padding: 15px;
            background: #f8fafc;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .extensions-row input {
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            outline: none;
        }
        
        /* Task Manager */
        .task-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
        }
        
        .task-input {
            flex: 1;
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            outline: none;
        }
        
        .task-input:focus {
            border-color: var(--accent);
        }
        
        .add-task-btn {
            padding: 15px 30px;
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .add-task-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(16, 185, 129, 0.4);
        }
        
        .task-list {
            max-height: 500px;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        
        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 12px;
            margin-bottom: 10px;
            border: 2px solid var(--border);
            transition: all 0.3s;
        }
        
        .task-item:hover {
            border-color: var(--accent);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .task-item.completed {
            background: #f0fdf4;
            border-color: var(--success);
        }
        
        .task-item.completed .task-text {
            text-decoration: line-through;
            color: #6b7280;
        }
        
        .task-text {
            flex: 1;
            font-size: 1rem;
            color: var(--dark);
        }
        
        .task-actions {
            display: flex;
            gap: 10px;
        }
        
        .task-btn {
            width: 35px;
            height: 35px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .task-btn.complete {
            background: linear-gradient(135deg, var(--success), #059669);
        }
        
        .task-btn.delete {
            background: linear-gradient(135deg, var(--error), #dc2626);
        }
        
        .task-btn:hover {
            transform: scale(1.1);
        }
        
        /* Notes */
        .notes-area {
            width: 100%;
            min-height: 200px;
            padding: 10px 15px;
            border: 2px solid var(--border);
            border-radius: 15px;
            font-size: 1rem;
            font-family: 'Poppins', 'Cairo', sans-serif;
            resize: vertical;
            outline: none;
            margin-bottom: 15px;
        }
        
        .notes-area:focus {
            border-color: var(--accent);
        }
        
        .notes-count {
            text-align: right;
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            font-weight: 600;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s ease;
            z-index: 1000;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 10px 15px;
            margin-top: 40px;
            color: white;
        }
        
        .footer-content {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .footer-contact {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .footer-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        @media (max-width: 768px) {
            /* Reduce body padding on mobile */
            body {
                padding: 5px 10px;
            }
            
            /* Header adjustments */
            header {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 1.6rem;
                letter-spacing: 2px;
            }
            
            /* Tool boxes - better mobile spacing */
            .tool-box {
                padding: 20px 15px;
                margin-bottom: 15px;
            }
            
            .tool-title {
                font-size: 1.1rem;
                padding: 12px 15px;
            }
            
            /* Input fields - larger for touch */
            input[type="text"],
            input[type="number"],
            input[type="date"],
            input[type="email"],
            textarea,
            select {
                font-size: 16px !important; /* Prevents zoom on iOS */
                padding: 14px !important;
                min-height: 48px; /* Touch-friendly */
            }
            
            /* Buttons - larger and stack better */
            .btn {
                padding: 14px 20px;
                font-size: 0.95rem;
                min-height: 48px; /* Touch-friendly */
                width: 100%;
            }
            
            .btn-group {
                flex-direction: column;
                gap: 12px;
                width: 100%;
            }
            
            /* Grid layouts to single column */
            .translator-grid,
            .date-converter-grid,
            .flat-rate-container,
            .calc-row,
            .calc-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .rooming-header,
            .rooming-row,
            .extensions-header,
            .extensions-row {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            /* Hide header labels on mobile for rooming/extensions */
            .rooming-header,
            .extensions-header {
                display: none;
            }
            
            /* Add labels to inputs on mobile */
            .rooming-row input::placeholder,
            .extensions-row input::placeholder {
                font-weight: 600;
            }
            
            /* Remove buttons - bigger touch target */
            .remove-day-btn {
                width: 100%;
                margin-top: 8px;
                padding: 12px;
                font-size: 1rem;
            }
            
            /* Swap button in translator */
            .swap-btn {
                width: 100%;
                height: 48px;
                border-radius: 12px;
                margin: 10px 0;
            }
            
            /* Task notes grid */
            .task-notes-grid {
                grid-template-columns: 1fr;
            }
            
            /* Result boxes */
            .result-box {
                padding: 15px;
            }
            
            .result-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .result-label {
                font-size: 0.85rem;
            }
            
            .result-value {
                font-size: 1.3rem;
            }
            
            /* Copy buttons */
            .copy-value-btn {
                padding: 8px 16px;
                font-size: 0.85rem;
            }
            
            /* Business Calculator responsive */
            .tool-box > div[style*="grid-template-columns: 1fr 1fr"] {
                grid-template-columns: 1fr !important;
            }
            
            .tool-box > div > div[style*="border-right"] {
                border-right: none !important;
                border-bottom: 2px solid var(--border) !important;
                padding-right: 0 !important;
                padding-bottom: 20px !important;
                margin-bottom: 20px;
            }
            
            .tool-box > div > div[style*="padding-left"] {
                padding-left: 0 !important;
            }
            
            /* Tables */
            .rooming-table,
            .extensions-table {
                font-size: 0.85rem;
            }
            
            .rooming-table th,
            .rooming-table td,
            .extensions-table th,
            .extensions-table td {
                padding: 10px 8px;
            }
        }
        
        .editable-select-wrapper {
            position: relative;
            width: 100%;
        }
        
        .editable-select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Poppins', 'Cairo', sans-serif;
            outline: none;
            list-style: none;
            cursor: pointer;
        }
        
        .editable-select option {
            padding: 10px;
        }
    
/* Email Forms - Modern Design */
.email-form {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    border-radius: 16px;
    margin-bottom: 20px;
    overflow: hidden;
    border: 1px solid #e2e8f0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.email-form:hover {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
    transform: translateY(-2px);
}

.form-header {
    padding: 18px 24px;
    background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
    color: white;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 600;
    font-size: 1rem;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    text-align: center;
}

.form-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
}

.form-header:hover::before {
    left: 100%;
}

.form-header:hover {
    background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
}

.form-header span:first-child {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    flex: 1;
}

.form-header span:last-child {
    font-size: 1.2rem;
    transition: transform 0.3s ease;
    display: inline-block;
}

.form-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.form-content.open {
    max-height: 600px;
}

.form-content.open + .form-header span:last-child {
    transform: rotate(180deg);
}

.form-html { scroll-behavior: smooth; }

        body {
    padding: 10px 15px;
}

.form-body {
    padding: 24px;
    background: white;
}

.form-field {
    margin-bottom: 20px;
}

.form-field label {
    display: block;
    font-weight: 700;
    color: #2d3748;
    margin-bottom: 10px;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.form-field .value {
    background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
    padding: 16px;
    border-radius: 12px;
    border: 2px solid #e2e8f0;
    white-space: pre-wrap;
    font-family: 'Courier New', monospace;
    font-size: 0.95rem;
    line-height: 1.6;
    color: #1a202c;
    transition: all 0.3s ease;
}

.form-field .value:hover {
    border-color: #cbd5e0;
    background: linear-gradient(135deg, #edf2f7 0%, #e2e8f0 100%);
}

.btn.btn-success {
    background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
    color: white;
    border: none;
    padding: 12px 28px;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(72, 187, 120, 0.3);
    font-size: 1rem;
}

.btn.btn-success:hover {
    background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(72, 187, 120, 0.4);
}

.btn.btn-success:active {
    transform: translateY(0);
    box-shadow: 0 2px 8px rgba(72, 187, 120, 0.3);
}

#emailFormsContainer {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 24px;
    flex: 1;
}

@media (max-width: 1024px) {
    #emailFormsContainer {
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
    }
}

@media (max-width: 600px) {
    #emailFormsContainer {
        grid-template-columns: 1fr;
        gap: 16px;
    }
    
    .form-header {
        padding: 16px 20px;
        font-size: 0.95rem;
    }
    
    .form-body {
        padding: 20px;
    }
    
    /* Extra small mobile improvements */
    h1 {
        font-size: 1.4rem;
    }
    
    .nav-link {
        padding: 8px 12px;
        font-size: 0.75rem;
    }
    
    .tool-title {
        font-size: 1rem;
        padding: 10px 12px;
    }
    
    .btn {
        font-size: 0.9rem;
        padding: 12px 16px;
    }
}

/* Very small phones */
@media (max-width: 400px) {
    body {
        padding: 5px;
    }
    
    .container {
        padding: 0;
    }
    
    .tool-box {
        padding: 15px 10px;
    }
    
    h1 {
        font-size: 1.2rem;
        letter-spacing: 1px;
    }
    
    .tool-title {
        font-size: 0.95rem;
        padding: 10px;
    }
    
    input[type="text"],
    input[type="number"],
    input[type="date"],
    textarea {
        padding: 12px !important;
    }
    
    .btn {
        padding: 12px;
        font-size: 0.85rem;
    }
    
    .nav-link {
        padding: 6px 8px;
        font-size: 0.7rem;
    }
}

</style>

<style>
/* HIDE OCR ENGINE BUTTONS */
.ocr-engine-btn,
#modeBtn_standard,
#modeBtn_passport,
#modeBtn_rooming {
  display: none !important;
}
</style>

<script>
function scoreWordConfidence(word) {
  let score = 100;
  if (word.length <= 1) score -= 40;
  if (/[Il|]{2,}/.test(word)) score -= 30;
  if (/[A-Z]{1}[0-9]/.test(word)) score -= 25;
  if (/[^A-Za-z0-9ء-ي]/.test(word)) score -= 20;
  return score;
}

const smartDictionary = {
  "MOHAMEO":"MOHAMED","MOHAMMD":"MOHAMMED","HUSSIEN":"HUSSEIN",
  "PASSP0RT":"PASSPORT","BIRTHOATE":"BIRTHDATE","NATlONALlTY":"NATIONALITY",
  "RO0M":"ROOM","TOTAI":"TOTAL","VAl":"VAT"
};

function aiWordCorrector(word){
  const w = word.toUpperCase();
  if (smartDictionary[w]) return smartDictionary[w];
  return w.replace(/0/g,"O").replace(/1/g,"I").replace(/5/g,"S").replace(/8/g,"B");
}

function aiReconstructLine(line){
  return line.split(" ").map(w=>{
    return scoreWordConfidence(w)<70 ? aiWordCorrector(w) : w;
  }).join(" ");
}

function aiArabicCorrection(text){
  const fixes = {
    "الاسـم":"الاسم","الجنسيـة":"الجنسية","تاريـخ":"تاريخ",
    "رقـم":"رقم","جـواز":"جواز","السفـر":"السفر"
  };
  Object.keys(fixes).forEach(k=>{
    text = text.replace(new RegExp(k,"g"),fixes[k]);
  });
  return text;
}

function aiAutoCorrect(text){
  let lines = text.split("\n").map(l=>aiReconstructLine(l));
  let out = lines.join("\n");
  out = aiArabicCorrection(out);
  if (typeof cleanOCRText === "function") out = cleanOCRText(out);
  if (typeof highlightLowConfidence === "function") out = highlightLowConfidence(out);
  return out;
}

// Force default OCR engine + mode
document.addEventListener("DOMContentLoaded",()=>{
  if (typeof setOCREngine === "function") setOCREngine("local");
  if (typeof setOCRMode === "function") setOCRMode("standard");
});
</script>


<style>
.app-title {
  white-space: nowrap !important;
  display: flex;
  align-items: center;
  gap: 8px;
}
@media (max-width: 480px) {
  .app-title { font-size: 0.95rem; }
}

/* Navigation Responsive Styles */
@media (max-width: 1024px) {
    .nav-links {
        gap: 8px;
        flex-wrap: wrap;
        justify-content: center;
    }
    .nav-link {
        padding: 8px 14px;
        font-size: 0.85rem;
    }
}

@media (max-width: 768px) {
    .nav-menu {
        padding: 15px 10px;
    }
    
    .nav-links {
        gap: 6px;
        flex-wrap: wrap;
        justify-content: center;
    }
    
    .nav-link {
        padding: 10px 14px;
        font-size: 0.8rem;
        min-width: auto;
        flex: 0 1 auto;
    }
}

@media (max-width: 600px) {
    .nav-links {
        gap: 6px;
        flex-wrap: wrap;
    }
    .nav-link {
        padding: 8px 12px;
        font-size: 0.75rem;
        flex: 0 1 calc(50% - 6px); /* Two columns */
        text-align: center;
    }
}
</style>


<style>
.app-title {
  white-space: nowrap !important;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  flex-wrap: nowrap;
}
</style>

<!-- Vercel Analytics -->
<script>
  window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
</script>
<script defer src="https://cdn.vercel-analytics.com/v1/script.js"></script>

</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>WORK SMART</h1>
                <div class="signature">By ALTANTAWY</div>
            </div>
        </header>
        
        <!-- Navigation Menu -->
        <nav class="nav-menu">
            <div class="nav-links">
                <a class="nav-link" href="#translator">🔤 Translator</a>
                <a class="nav-link" href="#date-converter">📅 Date</a>
                <a class="nav-link" href="#vat">💰 VAT</a>
                <a class="nav-link" href="#meals">🍽️ Meals</a>
                <a class="nav-link" href="#data-extraction">📤 Data</a>
                <a class="nav-link" href="#flat-rate">📊 Flat Rate</a>
                <a class="nav-link" href="#nights">🌙 Nights</a>
                <a class="nav-link" href="#business">💼 Business</a>
                <a class="nav-link" href="#rooming">🏨 Rooming</a>
                <a class="nav-link" href="#extensions">📋 Extensions</a>
                <a class="nav-link" href="#tasks">✅ Tasks</a>
                <a class="nav-link" href="#notes">📝 Notes</a>
                <a class="nav-link" href="#email">✉️ Email</a>
            </div>
        </nav>
        
        <!-- Name Translator -->
        <div class="tool-box" id="translator">
            <div class="tool-title">🔤 Name Translator - مترجم الأسماء</div>
<div id="namePreferences" style="display:none;">
    <div>
        <label style="font-weight:600; margin-right:6px;">Hussein:</label>
        <select id="husseinPreference" style="padding:6px 10px; border-radius:8px;">
            <option value="HUSSEIN">Hussein</option>
            <option value="HUSSIEN">Hussien</option>
        </select>
    </div>
    <div>
        <label style="font-weight:600; margin-right:6px;">Mohamed:</label>
        <select id="mohamedPreference" style="padding:6px 10px; border-radius:8px;">
            <option value="MOHAMED">Mohamed</option>
            <option value="MOHAMMED">Mohammed</option>
        </select>
    </div>
</div>

            <div class="translator-grid">
                <div class="input-section">
                    <div class="section-label">🇪🇬 Arabic Names</div>
                    <textarea 
                        id="inputText" 
                        class="arabic-input" 
                        placeholder="اكتب الأسماء بالعربي هنا..."
                        oninput="translateName()"
                    ></textarea>
                </div>
                <button class="swap-btn" onclick="swapLanguages()">⇄</button>
                <div class="input-section">
                    <div class="section-label">🇬🇧 English Translation</div>
                    <textarea 
                        id="outputText" 
                        class="english-output" 
                        readonly
                        placeholder="Translation will appear here..."
                    ></textarea>
                </div>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="copyToClipboard()">📋 Copy English Names</button>
                <button class="btn btn-secondary" onclick="clearAll()">🗑️ Clear All</button>
                <button class="btn btn-success" onclick="downloadAsText()">💾 Download as Text</button>
            </div>
        </div>
        
        <!-- Date Converter -->
        <div class="tool-box" id="date-converter">
            <div class="tool-title">📅 Date Converter - محول التاريخ</div>
            <div class="date-converter-grid">
                <!-- Gregorian to Hijri -->
                <div class="date-section">
                    <h3 style="color: var(--primary); margin-bottom: 20px; text-align: center;">Gregorian → Hijri</h3>
                    <div class="form-group">
                        <label>📆 Select Gregorian Date</label>
                        <input type="date" id="gregorianInput" oninput="autoConvertDate()">
                    </div>
                    <button class="btn btn-primary" style="width: 100%;" onclick="convertToHijri()">Convert to Hijri</button>
                    <div id="hijriResult" class="result-box">
                        <div class="result-label">Hijri Date</div>
                        <div class="result-value-wrapper">
    <span class="result-value" id="hijriDate"></span>
    <button class="copy-value-btn" onclick="copyValue('hijriDate')">Copy</button>
</div>
                    </div>
                </div>
                
                <!-- Hijri to Gregorian -->
                <div class="date-section">
                    <h3 style="color: var(--primary); margin-bottom: 20px; text-align: center;">Hijri → Gregorian</h3>
                    <div class="form-group">
                        <label>📆 Enter Hijri Date</label>
                        <div class="hijri-inputs">
                            <input type="number" id="hijriDay" placeholder="Day" min="1" max="30">
                            <select id="hijriMonth">
                                <option value="1">Muharram</option>
                                <option value="2">Safar</option>
                                <option value="3">Rabi' al-awwal</option>
                                <option value="4">Rabi' al-thani</option>
                                <option value="5">Jumada al-awwal</option>
                                <option value="6">Jumada al-thani</option>
                                <option value="7">Rajab</option>
                                <option value="8">Sha'ban</option>
                                <option value="9">Ramadan</option>
                                <option value="10">Shawwal</option>
                                <option value="11">Dhu al-Qi'dah</option>
                                <option value="12">Dhu al-Hijjah</option>
                            </select>
                            <input type="number" id="hijriYear" placeholder="Year" min="1">
                        </div>
                    </div>
                    <button class="btn btn-primary" style="width: 100%;" onclick="convertToGregorian()">Convert to Gregorian</button>
                    <div id="gregorianResult" class="result-box">
                        <div class="result-label">Gregorian Date</div>
                        <div class="result-value" id="gregorianDate"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- VAT Calculator & Meals Calculator Side by Side -->
        <div class="tools-grid">
            <!-- VAT Calculator -->
            <div class="tool-box" id="vat">
                <div class="tool-title">💰 VAT (TAX) Calculator - حاسبة الضريبة</div>
                
                <div class="calc-grid">
                    <div class="input-group">
                        <label>Amount (Including VAT)</label>
                        <input type="number" id="vatAmount" placeholder="Enter amount with VAT" oninput="calculateVATFromIncluding()">
                    </div>
                    <div class="input-group">
                        <label>Amount (Excluding VAT)</label>
                        <input type="number" id="vatAmountExcluding" placeholder="Enter amount without VAT" oninput="calculateVATFromExcluding()">
                    </div>
                </div>
                
                <div class="result-box" id="vatResult" style="display: none;">
                    <div class="result-item">
                        <span class="result-label">Amount Without VAT:</span>
                        <div class="result-value-wrapper">
    <span class="result-value" id="vatWithout">0.00</span>
    <button class="copy-value-btn" onclick="copyValue('vatWithout')">Copy</button>
</div>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Amount With VAT:</span>
                        <div class="result-value-wrapper">
    <span class="result-value" id="vatWith">0.00</span>
    <button class="copy-value-btn" onclick="copyValue('vatWith')">Copy</button>
</div>
                    </div>
                    <div class="result-item">
                        <span class="result-label">VAT Amount (15%):</span>
                        <div class="result-value-wrapper">
                            <span class="result-value" id="vatOnly">0.00</span>
                            
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Meals Calculator -->
            <div class="tool-box" id="meals">
                <div class="tool-title">🍽️ Meals Calculator - حاسبة الوجبات</div>
                
                <div class="calc-grid">
                    <div class="input-group">
                        <label>Meal Price (per person)</label>
                        <input type="number" id="mealPrice" placeholder="Enter meal price" oninput="calculateMeals()">
                    </div>
                    <div class="input-group">
                        <label>Days</label>
                        <input type="number" id="mealDays" placeholder="Enter number of days" oninput="calculateMeals()">
                    </div>
                </div>
                
                <div class="result-box" id="mealsResult" style="display: none;">
                    <div class="result-item">
                        <span class="result-label">Total WITH VAT:</span>
                        <div class="result-value-wrapper">
    <span class="result-value" id="mealsWithVat">0.00</span>
    <button class="copy-value-btn" onclick="copyValue('mealsWithVat')">Copy</button>
</div>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Total WITHOUT VAT:</span>
                        <div class="result-value-wrapper">
    <span class="result-value" id="mealsWithoutVat">0.00</span>
    <button class="copy-value-btn" onclick="copyValue('mealsWithoutVat')">Copy</button>
</div>
                    </div>
                </div>
                
                <div class="description-box">
                    <h4>وصف الإستخدام</h4>
                    <p>في سيستم AMR 
في خانة خدمات أخرى
ستقوم بكتابة عدد الأشخاص المطلوب الوجبات لهم في خانة QTY 
وستأخذ الإجمالي الذي تم إحتسابه بالأعلى بدون الضريبة 
ووضعه في خانة البيع أو الكوست حسب سعر الوجبة وعدد الأيام وسيقوم السيستم بإحتساب الإجمالي النهائي.</p>
                </div>
            </div>
        </div>
        
        <!-- DATA EXTRACTION Tool -->
        <!-- ===================== EXTRACTOR DATA TOOL UI ===================== -->
<div class="tool-box" id="data-extraction">
  <div class="tool-title">📤 DATA EXTRACTION مستخلص البيانات</div>

  <!-- OCR MODE TABS -->
  <div style="display:flex;gap:8px;margin-bottom:14px;flex-wrap:wrap;">
    <button id="modeBtn_standard" class="ocr-mode-btn ocr-mode-active" onclick="setOCRMode('standard')">📄 Standard</button>
    <button id="modeBtn_passport" class="ocr-mode-btn" onclick="setOCRMode('passport')">🧾 Passport / MRZ</button>
    <button id="modeBtn_rooming" class="ocr-mode-btn" onclick="setOCRMode('rooming')">🛏️ Rooming</button>
  </div>

  <!-- ===== PASSPORT AUTO-FILL PANEL ===== -->
  <div id="passportAutoFill" class="input-section" style="display:none">
    <div class="section-label">🛂 Passport Auto-Fill</div>
    <input name="name" placeholder="Full Name" style="width:100%;margin-bottom:6px">
    <input name="nationality" placeholder="Nationality" style="width:100%;margin-bottom:6px">
    <input name="dob" placeholder="Date of Birth" style="width:100%">
  </div>

  <!-- DRAG & DROP UPLOAD ZONE -->
  <div id="dropZone" class="drop-zone"
    ondragover="event.preventDefault();this.classList.add('drop-zone-hover')"
    ondragleave="this.classList.remove('drop-zone-hover')"
    ondrop="handleDrop(event)"
    onclick="document.getElementById('ocrImage').click()">
    <div style="font-size:2rem;margin-bottom:6px;">📂</div>
    <div style="font-weight:700;font-size:0.95rem;">Click or Drag & Drop</div>
    <div style="font-size:0.8rem;color:#888;margin-top:4px;">Images (JPG, PNG) or PDF — multiple files supported</div>
    <input type="file" id="ocrImage" accept="image/*,.pdf" multiple style="display:none" onchange="runBatchOCR()">
  </div>

  <!-- FILE PREVIEW LIST -->
  <div id="filePreviewList" style="display:none;margin:8px 0;font-size:0.82rem;color:#555;"></div>

  <!-- PROGRESS BAR -->
  <div id="ocrProgressWrap" style="display:none;margin:10px 0;">
    <div style="font-size:0.82rem;color:#555;margin-bottom:4px;" id="ocrProgressLabel">Processing...</div>
    <div style="background:#e0e0e0;border-radius:20px;height:10px;overflow:hidden;">
      <div id="ocrProgressBar" style="height:100%;width:0%;background:linear-gradient(90deg,#3498db,#2ecc71);border-radius:20px;transition:width 0.3s;"></div>
    </div>
  </div>

  <!-- RESULT AREA -->
  <div class="input-section" style="margin-top:12px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
      <div class="section-label" style="margin:0;">📄 Extracted Data</div>
      <div style="display:flex;gap:6px;align-items:center;">
        <span id="charCount" style="font-size:0.75rem;color:#999;">0 chars</span>
        <button class="ocr-mini-btn" onclick="copyOCRResult()" title="Copy all text">📋 Copy</button>
        <button class="ocr-mini-btn ocr-mini-danger" onclick="clearOCRResult()" title="Clear">🗑️ Clear</button>
      </div>
    </div>
    <textarea id="ocrResult" placeholder="OCR results will appear here... You can also type or paste text directly." style="min-height:160px;" oninput="updateCharCount()"></textarea>
  </div>

  <!-- ACTION BUTTONS -->
  <div class="btn-group" style="margin-top:10px;flex-wrap:wrap;gap:6px;">
    <button class="btn btn-primary" onclick="detectTable()">📑 Detect Table</button>
    <button class="btn btn-secondary" onclick="autoSplitData()">🧠 Auto Split</button>
    <button class="btn btn-success" onclick="exportRoomingExcel()">📊 Export Excel</button>
    <button class="btn btn-secondary" id="sendToTranslatorBtn" style="display:none;" onclick="sendToTranslator()">🌐 Translate Arabic</button>
  </div>

  <!-- STATUS TOAST INLINE -->
  <div id="ocrStatus" style="display:none;margin-top:10px;padding:8px 14px;border-radius:8px;font-size:0.85rem;font-weight:600;"></div>

  <!-- ACCURACY NOTE -->
  <div class="description-box" style="margin-top:16px;padding:14px;">
    <h4 style="font-size:0.82rem;margin-bottom:7px;">📌 ملاحظة / Note</h4>
    <p style="font-size:0.75rem;line-height:1.7;">دقة إستخراج البيانات ٧٠ % وجاري العمل علي تطويرها لتصبح أفضل Data extraction accuracy is 70% and it is underway to improve it .</p>
  </div>

</div><!-- END extractorDataTool -->

<style>
.ocr-mode-btn {
  padding: 7px 16px;
  border: 2px solid #3498db;
  background: #fff;
  color: #3498db;
  border-radius: 20px;
  cursor: pointer;
  font-weight: 600;
  font-size: 0.82rem;
  transition: all 0.2s;
}
.ocr-mode-btn:hover { background: #ebf5fb; }
.ocr-mode-active {
  background: #3498db !important;
  color: #fff !important;
}
.drop-zone {
  border: 2px dashed #3498db;
  border-radius: 12px;
  padding: 28px 20px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s;
  background: #f8fbff;
}
.drop-zone:hover, .drop-zone-hover {
  background: #ebf5fb;
  border-color: #2980b9;
}
.ocr-mini-btn {
  padding: 3px 10px;
  border: 1px solid #ccc;
  background: #f5f5f5;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.78rem;
  transition: background 0.15s;
}
.ocr-mini-btn:hover { background: #e0e0e0; }
.ocr-mini-danger { border-color: #e74c3c; color: #e74c3c; }
.ocr-mini-danger:hover { background: #fdecea; }
</style>
</div>

        <!-- Flat Rate Calculator -->
        <div class="tool-box" id="flat-rate">
            <div class="tool-title">📊 Flat Rate Calculator - حاسبة الأسعار</div>
            <div class="flat-rate-container">
                <!-- Method 1: W.D / W.E -->
                <div class="flat-section">
                    <h4>Method 1: Weekdays / Weekend</h4>
                    <div class="flat-input-grid">
                        <div></div>
                        <div style="text-align: center; font-weight: 700; color: var(--primary);">PRICE</div>
                        <div style="text-align: center; font-weight: 700; color: var(--primary);">DAYS</div>
                    </div>
                    <div class="flat-input-grid">
                        <div style="font-weight: 700; color: var(--dark);">W.D</div>
                        <input type="number" id="wdPrice" placeholder="0" oninput="calculateFlatRate1()">
                        <input type="number" id="wdDays" placeholder="0" oninput="calculateFlatRate1()">
                    </div>
                    <div class="flat-input-grid">
                        <div style="font-weight: 700; color: var(--dark);">W.E</div>
                        <input type="number" id="wePrice" placeholder="0" oninput="calculateFlatRate1()">
                        <input type="number" id="weDays" placeholder="0" oninput="calculateFlatRate1()">
                    </div>
                    <div class="flat-result">
                        <button class="copy-result-btn" onclick="copyFlatRate1()">📋 Copy</button>
                        <div class="flat-result-label">FLAT RATE</div>
                        <div class="flat-result-value" id="flatRate1">0</div>
                    </div>
                </div>
                
                <!-- Method 2: Daily Selection -->
                <div class="flat-section">
                    <h4>Method 2: Daily Price Selection</h4>
                    <div id="dailyPricesList">
                        <div class="day-item">
                            <select class="day-select" onchange="updateDaySequence(this)">
                                <option value="Saturday">Saturday</option>
                                <option value="Sunday">Sunday</option>
                                <option value="Monday">Monday</option>
                                <option value="Tuesday">Tuesday</option>
                                <option value="Wednesday">Wednesday</option>
                                <option value="Thursday">Thursday</option>
                                <option value="Friday">Friday</option>
                            </select>
                            <input type="number" class="day-price" placeholder="Price" oninput="calculateFlatRate2()">
                            <button class="remove-day-btn" onclick="removeDayItem(this)">✕</button>
                        </div>
                        <div class="day-item">
                            <select class="day-select" onchange="updateDaySequence(this)">
                                <option value="Saturday">Saturday</option>
                                <option value="Sunday" selected>Sunday</option>
                                <option value="Monday">Monday</option>
                                <option value="Tuesday">Tuesday</option>
                                <option value="Wednesday">Wednesday</option>
                                <option value="Thursday">Thursday</option>
                                <option value="Friday">Friday</option>
                            </select>
                            <input type="number" class="day-price" placeholder="Price" oninput="calculateFlatRate2()">
                            <button class="remove-day-btn" onclick="removeDayItem(this)">✕</button>
                        </div>
                    </div>
                    <button class="btn btn-primary" style="width: 100%; margin-bottom: 15px;" onclick="addDayItem()">➕ Add Day</button>
                    <div class="flat-result">
                        <button class="copy-result-btn" onclick="copyFlatRate2()">📋 Copy</button>
                        <div class="flat-result-label">FLAT RATE</div>
                        <div class="flat-result-value" id="flatRate2">0</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Nights Calculator & Placeholder Side by Side -->
        <div class="tools-grid">
            <!-- Nights Calculator -->
            <div class="tool-box" id="nights">
                <div class="tool-title">🌙 Nights Calculator - حاسبة الليالي</div>
                
                <div class="calc-grid">
                    <div class="input-group">
                        <label>Check-In Date - تاريخ الدخول</label>
                        <input type="date" id="checkInDate" onchange="calculateNights()">
                    </div>
                    <div class="input-group">
                        <label>Check-Out Date - تاريخ الخروج</label>
                        <input type="date" id="checkOutDate" onchange="calculateNights()">
                    </div>
                </div>
                
                <div class="nights-result" id="nightsResult">
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                        <div class="nights-label">
                            Total Nights - إجمالي الليالي:
                            <span class="nights-value" id="nightsValue">0</span>
                        </div>
                        <div class="nights-breakdown">
                            <span class="breakdown-label">W.D (Weekday)</span>
                            <span class="breakdown-value" id="weekdayValue">0</span>
                        </div>
                        <div class="nights-breakdown weekend">
                            <span class="breakdown-label">W.E (Weekend)</span>
                            <span class="breakdown-value" id="weekendValue">0</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Business Calculator -->
            <div class="tool-box" id="business">
                <div class="tool-title">💼 Business Calculator - حاسبة الأعمال</div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 20px;">
                    <!-- Profit Calculator -->
                    <div style="border-right: 2px solid var(--border); padding-right: 20px;">
                        <h4 style="color: var(--primary); margin-bottom: 15px; text-align: center;">💰 Profit Calculator</h4>
                        <div class="calc-grid">
                            <div class="input-group">
                                <label>COST - التكلفة</label>
                                <input type="number" id="businessCost" placeholder="Enter cost" oninput="calculateBusiness()">
                            </div>
                            <div class="input-group">
                                <label>SELL - البيع</label>
                                <input type="number" id="businessSell" placeholder="Enter sell price" oninput="calculateBusiness()">
                            </div>
                        </div>
                        
                        <div class="business-result" id="businessResult">
                            <div class="business-display">
                                <span class="business-label">PROFIT - الربح:</span>
                                <span class="business-value" id="businessProfit">0.00</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Reservation Counter -->
                    <div style="padding-left: 20px;">
                        <h4 style="color: var(--primary); margin-bottom: 15px; text-align: center;">📊 Reservation Counter</h4>
                        <div id="reservationBoxes">
                            <div class="reservation-item" style="display: flex; gap: 10px; margin-bottom: 10px; align-items: center;">
                                <input type="number" class="reservation-input" placeholder="0" oninput="calculateReservationTotal()" style="flex: 1; padding: 12px; border: 2px solid var(--border); border-radius: 10px; font-size: 1rem;">
                                <button onclick="removeReservationBox(this)" style="background: var(--error); color: white; border: none; border-radius: 8px; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem;">✕</button>
                            </div>
                            <div class="reservation-item" style="display: flex; gap: 10px; margin-bottom: 10px; align-items: center;">
                                <input type="number" class="reservation-input" placeholder="0" oninput="calculateReservationTotal()" style="flex: 1; padding: 12px; border: 2px solid var(--border); border-radius: 10px; font-size: 1rem;">
                                <button onclick="removeReservationBox(this)" style="background: var(--error); color: white; border: none; border-radius: 8px; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem;">✕</button>
                            </div>
                            <div class="reservation-item" style="display: flex; gap: 10px; margin-bottom: 10px; align-items: center;">
                                <input type="number" class="reservation-input" placeholder="0" oninput="calculateReservationTotal()" style="flex: 1; padding: 12px; border: 2px solid var(--border); border-radius: 10px; font-size: 1rem;">
                                <button onclick="removeReservationBox(this)" style="background: var(--error); color: white; border: none; border-radius: 8px; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem;">✕</button>
                            </div>
                            <div class="reservation-item" style="display: flex; gap: 10px; margin-bottom: 10px; align-items: center;">
                                <input type="number" class="reservation-input" placeholder="0" oninput="calculateReservationTotal()" style="flex: 1; padding: 12px; border: 2px solid var(--border); border-radius: 10px; font-size: 1rem;">
                                <button onclick="removeReservationBox(this)" style="background: var(--error); color: white; border: none; border-radius: 8px; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem;">✕</button>
                            </div>
                        </div>
                        
                        <button class="btn btn-primary" style="width: 100%; margin-bottom: 15px;" onclick="addReservationBox()">➕ Add Box</button>
                        
                        <div style="background: linear-gradient(135deg, #1e3a8a, #1e40af); padding: 10px 15px; border-radius: 15px; text-align: center;">
                            <div style="color: white; font-size: 0.9rem; margin-bottom: 5px;">TOTAL RESERVATIONS</div>
                            <div style="color: white; font-size: 2rem; font-weight: 700;" id="reservationTotal">0</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Rooming List Maker -->
        <div class="tool-box" id="rooming">
            <div class="tool-title">🏨 Rooming List Maker - قائمة الغرف</div>
            
            <div class="rooming-header">
                <div>GUEST NAME</div>
                <div>ROOMS</div>
                <div>ROOM TYPE</div>
                <div>MEAL TYPE</div>
                <div>VIEW TYPE</div>
                <div></div>
            </div>
            
            <div id="roomingList">
                <div class="rooming-row">
                    <input type="text" class="guest-name" placeholder="Guest Name">
                    <input type="number" class="room-number" placeholder="Rooms" min="1">
                    
<input list="roomTypes" class="room-type" placeholder="Room Type">
<datalist id="roomTypes">
  <option value="SGL"><option value="DBL"><option value="TRPL"><option value="QUAD">
  <option value="QUIENT"><option value="STUDIO">
  <option value="1B SUITE"><option value="2B SUITE"><option value="3B SUITE">
  <option value="ROYAL SUITE">
  <option value="1B APARTMENT"><option value="2B APARTMENT"><option value="3B APARTMENT">
</datalist>

<input list="mealTypes" class="meal-type" placeholder="Meal Type">
<datalist id="mealTypes">
  <option value="R.O"><option value="B.B"><option value="H.B"><option value="F.B">
</datalist>

<input list="viewTypes" class="view-type" placeholder="View Type">
<datalist id="viewTypes">
  <option value="C.V"><option value="N.V"><option value="K.V"><option value="H.V">
  <option value="PARTIAL K.V"><option value="PARTIAL H.V"><option value="PREMIER K.V">
</datalist>

                    <button class="remove-day-btn" onclick="removeRoomingRow(this)">✕</button>
                </div>
            </div>
            
            <button class="btn btn-primary" style="width: 100%; margin-top: 15px;" onclick="addRoomingRow()">➕ Add Guest</button>
            
            <div class="btn-group" style="margin-top: 20px;">
                <button class="btn btn-success" onclick="generateRoomingPreview()">👁️ Preview</button>
                <button class="btn btn-primary" onclick="saveRoomingAsImage()">🖼️ Save as Image</button>
                <button class="btn btn-primary" onclick="saveRoomingAsExcel()">📊 Save as Excel</button>
                <button class="btn btn-secondary" onclick="clearRoomingList()">🗑️ Clear All</button>
            </div>
            
            <div id="roomingPreview" class="rooming-preview">
                <h3 style="color: var(--primary); text-align: center; margin-bottom: 20px;">ROOMING LIST</h3>
                <table class="rooming-table" id="roomingTable">
                    <thead>
                        <tr>
                            <th>GUEST NAME</th>
                            <th>ROOMS</th>
                            <th>ROOM TYPE</th>
                            <th>MEAL TYPE</th>
                            <th>VIEW TYPE</th>
                        </tr>
                    </thead>
                    <tbody id="roomingTableBody">
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Extensions Maker -->
        <div class="tool-box" id="extensions">
            <div class="tool-title">📋 Extensions Maker - تمديدات الفنادق</div>
            
            <div class="extensions-header">
                <div>GUEST NAME</div>
                <div>OLD HCN</div>
                <div>NEW HCN</div>
                <div>FROM</div>
                <div>TO</div>
                <div></div>
            </div>
            
            <div id="extensionsList">
                <div class="extensions-row">
                    <input type="text" class="ext-guest-name" placeholder="Guest Name">
                    <input type="text" class="ext-old-hcn" placeholder="Old HCN">
                    <input type="text" class="ext-new-hcn" placeholder="New HCN">
                    <input type="date" class="ext-from">
                    <input type="date" class="ext-to">
                    <button class="remove-day-btn" onclick="removeExtensionRow(this)">✕</button>
                </div>
            </div>
            
            <button class="btn btn-primary" style="width: 100%; margin-top: 15px;" onclick="addExtensionRow()">➕ Add Extension</button>
            
            <div class="btn-group" style="margin-top: 20px;">
                <button class="btn btn-success" onclick="generateExtensionsPreview()">👁️ Preview</button>
                <button class="btn btn-primary" onclick="saveExtensionsAsImage()">🖼️ Save as Image</button>
                <button class="btn btn-primary" onclick="saveExtensionsAsExcel()">📊 Save as Excel</button>
                <button class="btn btn-secondary" onclick="clearExtensionsList()">🗑️ Clear All</button>
            </div>
            
            <div id="extensionsPreview" class="extensions-preview">
                <h3 style="color: var(--primary); text-align: center; margin-bottom: 20px;">EXTENSIONS LIST</h3>
                <table class="extensions-table" id="extensionsTable">
                    <thead>
                        <tr>
                            <th>GUEST NAME</th>
                            <th>OLD HCN</th>
                            <th>NEW HCN</th>
                            <th>FROM</th>
                            <th>TO</th>
                        </tr>
                    </thead>
                    <tbody id="extensionsTableBody">
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Task Manager & Notes Side by Side -->
        <div class="task-notes-grid">
            <!-- Task Manager -->
            <div class="tool-box" id="tasks">
                <div class="tool-title">✅ Task Manager - مدير المهام</div>
                
                <div class="task-input-group">
                    <input type="text" id="taskInput" class="task-input" placeholder="Add a new task..." onkeypress="if(event.key === 'Enter') addTask()">
                    <button class="add-task-btn" onclick="addTask()">➕ Add Task</button>
                </div>
                
                <div id="taskList" class="task-list"></div>
                
                <div class="btn-group">
                    <button class="btn btn-success" onclick="saveTasksManually()">💾 Save Tasks</button>
                    <button class="btn btn-primary" onclick="exportTasks()">📥 Export Tasks</button>
                    <button class="btn btn-secondary" onclick="clearCompletedTasks()">🗑️ Clear Completed</button>
                    <button class="btn btn-secondary" onclick="clearAllTasks()">🗑️ Clear All</button>
                </div>
            </div>
            
            <!-- Notes -->
            <div class="tool-box" id="notes">
                <div class="tool-title">📝 Quick Notes - ملاحظات سريعة</div>
                
                <textarea 
                    id="notesArea" 
                    class="notes-area" 
                    placeholder="Write your notes here..."
                    oninput="updateNotesCount()"
                ></textarea>
                
                <div class="notes-count" id="notesCount">0 characters</div>
                
                <div class="btn-group">
                    <button class="btn btn-success" onclick="saveNotes()">💾 Save Notes</button>
                    <button class="btn btn-primary" onclick="exportNotes()">📥 Export Notes</button>
                    <button class="btn btn-secondary" onclick="clearNotes()">🗑️ Clear Notes</button>
                </div>
            </div>
        </div>
        
        
        <!-- Email Forms Tool -->
        <div class="tool-box" id="email">
            <div class="tool-title">✉️ Email Forms - صيغ الإيميلات</div>
            
            <div id="emailFormsContainer"></div>
        </div>
        
<!-- Footer -->
        <footer>
            <div class="footer-content">⚡ THIS APP IS POWERED BY</div>
            <div class="footer-content">MR. HUSSIEN ALTANTAWY</div>
            <div class="footer-contact">
                <div class="footer-item">📱 +2 012 81 80 64 61</div>
                <div class="footer-item">📧 <a href="/cdn-cgi/l/email-protection#eda5b8bebea4a8a3c3aca1b9aca3b9acbab4adb4aca5a2a2c3aea2a0" style="color: white; text-decoration: none;"><span class="__cf_email__" data-cfemail="175f4244445e525939565b4356594356404e574e565f58583954585a">[email&#160;protected]</span></a></div>
            </div>
        


</footer>
    </div>
    
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
        // Email decode fallback (in case Cloudflare protection doesn't work)
        function decodeEmail(encodedString) {
            var email = '', r = parseInt(encodedString.substr(0, 2), 16), n, i;
            for (n = 2; encodedString.length - n; n += 2) {
                i = parseInt(encodedString.substr(n, 2), 16) ^ r;
                email += String.fromCharCode(i);
            }
            return email;
        }
        
        // Decode protected emails on page load
        document.addEventListener('DOMContentLoaded', function() {
            var emailElements = document.querySelectorAll('span[data-cfemail]');
            emailElements.forEach(function(element) {
                var encoded = element.getAttribute('data-cfemail');
                if (encoded) {
                    var decoded = decodeEmail(encoded);
                    element.textContent = decoded;
                    
                    // Update parent link if it exists
                    var parentLink = element.closest('a[href*="email-protection"]');
                    if (parentLink) {
                        parentLink.href = 'mailto:' + decoded;
                    }
                }
            });
        });
        
        // Enhanced Arabic to English Translation Map with Smart Phonetic Rules
        const arabicToEnglish = {
            'ا': 'A', 'أ': 'A', 'إ': 'I', 'آ': 'A',
            'ب': 'B', 'ت': 'T', 'ث': 'TH', 'ج': 'G',
            'ح': 'H', 'خ': 'KH', 'د': 'D', 'ذ': 'TH',
            'ر': 'R', 'ز': 'Z', 'س': 'S', 'ش': 'SH',
            'ص': 'S', 'ض': 'D', 'ط': 'T', 'ظ': 'Z',
            'ع': 'A', 'غ': 'GH', 'ف': 'F', 'ق': 'K',
            'ك': 'K', 'ل': 'L', 'م': 'M', 'ن': 'N',
            'ه': 'H', 'ة': 'H', 'و': 'W', 'ي': 'Y',
            'ى': 'A', 'ؤ': 'O', 'ئ': 'E', 'ء': 'A',
            'َ': 'A', 'ً': 'AN', 'ُ': 'U', 'ٌ': 'UN',
            'ِ': 'I', 'ٍ': 'IN', 'ْ': '', 'ّ': ''
        };
        
        // Smart phonetic patterns for better name transliteration
        
// ================= NAME TRANSLATION ENHANCEMENTS =================
const nameDictionary = {
    "محمد": ["MOHAMMED", "MOHAMED"],
    "محمود": ["MAHMOUD"],
    "مصطفى": ["MOSTAFA"],
    "مروان": ["MARWAN"],
    "ماجد": ["MAJED"],
    "احمد": ["AHMED"],
    "أحمد": ["AHMED"],
    "عبدالله": ["ABDULLAH"],
    "عبد الله": ["ABDULLAH"],
    "عبدالرحمن": ["ABDUL RAHMAN"],
    "عمر": ["OMAR"],
    "علي": ["ALI"],
    "عادل": ["ADEL"],
    "حسين": ["HUSSEIN", "HUSSIEN"],
    "حسن": ["HASSAN"],
    "حمزة": ["HAMZA"],
    "هادي": ["HADI"],
    "خالد": ["KHALID"],
    "كريم": ["KARIM"],
    "كمال": ["KAMAL"],
    "يوسف": ["YOUSEF", "YUSUF"],
    "ياسر": ["YASSER"],
    "يحيى": ["YAHYA"],
    "سعيد": ["SAEED"],
    "سامح": ["SAMEH"],
    "سامي": ["SAMY"],
    "شريف": ["SHERIF"],
    "فهد": ["FAHAD"],
    "فارس": ["FARES"],
    "نادر": ["NADER"],
    "رامي": ["RAMY"],
    "رائد": ["RAED"],
    "زكريا": ["ZAKARIA"],
    "زياد": ["ZIAD"]
};

function pickPreferredSpelling(spellings, arabicWord) {
    if (arabicWord === "حسين") {
        return document.getElementById('husseinPreference').value;
    }
    if (arabicWord === "محمد") {
        return document.getElementById('mohamedPreference').value;
    }
    return spellings[0];
}
// ================= END NAME ENHANCEMENTS =================

function capitalizeName(text) {
    return text
        .toLowerCase()
        .split(' ')
        .map(word => word ? word.charAt(0).toUpperCase() + word.slice(1) : '')
        .join(' ');
}

function loadNamePreferences() {
    const h = localStorage.getItem('husseinPreference');
    const m = localStorage.getItem('mohamedPreference');
    if (h) document.getElementById('husseinPreference').value = h;
    if (m) document.getElementById('mohamedPreference').value = m;
}

function saveNamePreferences() {
    localStorage.setItem('husseinPreference', document.getElementById('husseinPreference').value);
    localStorage.setItem('mohamedPreference', document.getElementById('mohamedPreference').value);
}

document.addEventListener('DOMContentLoaded', () => {
    loadNamePreferences();
    document.getElementById('husseinPreference').addEventListener('change', saveNamePreferences);
    document.getElementById('mohamedPreference').addEventListener('change', saveNamePreferences);
});


function smartTransliterate(word) {
            let result = '';
            const chars = word.split('');
            
            for (let i = 0; i < chars.length; i++) {
                const char = chars[i];
                const nextChar = chars[i + 1] || '';
                const prevChar = chars[i - 1] || '';
                
                if (char === ' ') {
                    result += ' ';
                    continue;
                }
                
                // Handle special combinations
                if (char === 'س' && nextChar === 'ك' && chars[i + 2] === 'ا' && chars[i + 3] === 'ي') {
                    // سكاي = SKY
                    result += 'SKY';
                    i += 3;
                    continue;
                }
                
                if (char === 'ج' && nextChar === 'ر' && chars[i + 2] === 'و' && chars[i + 3] === 'ب') {
                    // جروب = GROUP
                    result += 'GROUP';
                    i += 3;
                    continue;
                }
                
                if (char === 'ج' && nextChar === 'ي' && chars[i + 2] === 'م' && chars[i + 3] === 'س') {
                    // جيمس = JAMES
                    result += 'JAMES';
                    i += 3;
                    continue;
                }
                
                if (char === 'ج' && nextChar === 'و' && chars[i + 2] === 'ن') {
                    // جون = JOHN
                    result += 'JOHN';
                    i += 2;
                    continue;
                }
                
                // Handle 'ج' more intelligently
                if (char === 'ج') {
                    // Check if it's likely a 'J' sound (like James, John)
                    if (nextChar === 'ي' || nextChar === 'و') {
                        result += 'J';
                    } else {
                        result += 'G';
                    }
                    continue;
                }
                
                // Handle 'ق' as 'K' for names
                if (char === 'ق') {
                    result += 'K';
                    continue;
                }
                
                // Handle double vowels
                if (char === 'و' && prevChar === 'و') {
                    result += 'O';
                    continue;
                }
                
                if (char === 'ي' && prevChar === 'ي') {
                    result += 'E';
                    continue;
                }
                
                // Handle 'ة' at the end of words
                if (char === 'ة' || char === 'ه') {
                    if (i === chars.length - 1 || chars[i + 1] === ' ') {
                        result += 'H';
                        continue;
                    }
                }
                
                // Standard transliteration
                if (arabicToEnglish[char]) {
                    result += arabicToEnglish[char];
                }
            }
            
            return result;
        }
        
        
function translateName() {
    const input = document.getElementById('inputText').value;
    const lines = input.split('\n');

    const translatedLines = lines.map(line => {
        if (!line.trim()) return '';

        const words = line.trim().split(/\s+/);
        const translatedWords = words.map(word => {
            if (nameDictionary[word]) {
                return pickPreferredSpelling(nameDictionary[word]);
            }
            return smartTransliterate(word);
        });

        return capitalizeName(translatedWords.join(' '));
    });

    document.getElementById('outputText').value = translatedLines.join('\n');
}
function swapLanguages() {
            const input = document.getElementById('inputText');
            const output = document.getElementById('outputText');
            const temp = input.value;
            input.value = output.value;
            output.value = temp;
        }
        
        function copyToClipboard() {
            const output = document.getElementById('outputText');
            output.select();
            document.execCommand('copy');
            showToast('Copied to clipboard!');
        }
        
        function clearAll() {
            document.getElementById('inputText').value = '';
            document.getElementById('outputText').value = '';
            showToast('Cleared!');
        }
        
        function downloadAsText() {
            const output = document.getElementById('outputText').value;
            if (!output.trim()) {
                showToast('Nothing to download!');
                return;
            }
            const blob = new Blob([output], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'translated_names.txt';
            a.click();
            URL.revokeObjectURL(url);
            showToast('Downloaded!');
        }
        
        // Date Converter Functions
        function convertToHijri() {
            const gregorianInput = document.getElementById('gregorianInput').value;
            if (!gregorianInput) {
                showToast('Please select a Gregorian date!');
                return;
            }
            
            const gregorianDate = moment(gregorianInput, 'YYYY-MM-DD');
            const hijriDateFormatted = gregorianDate.format('iD/iM/iYYYY');
            const dayName = gregorianDate.format('dddd');
            
            const resultBox = document.getElementById('hijriResult');
            const dateElement = document.getElementById('hijriDate');
            
            // Check if Thursday or Friday
            if (dayName === 'Thursday' || dayName === 'Friday') {
                resultBox.classList.add('weekend');
                dateElement.innerHTML = `${hijriDateFormatted}<br>${dayName} <span class="weekend-badge">(WEEK END)</span>`;
            } else {
                resultBox.classList.remove('weekend');
                dateElement.innerHTML = `${hijriDateFormatted}<br>${dayName}`;
            }
            
            resultBox.style.display = 'block';
        }
        
        function convertToGregorian() {
            const day = document.getElementById('hijriDay').value;
            const month = document.getElementById('hijriMonth').value;
            const year = document.getElementById('hijriYear').value;
            
            if (!day || !month || !year) {
                showToast('Please fill all Hijri date fields!');
                return;
            }
            
            if (day < 1 || day > 30) {
                showToast('Day must be between 1 and 30!');
                return;
            }
            
            if (year < 1) {
                showToast('Please enter a valid year!');
                return;
            }
            
            const hijriDate = moment(`${year}/${month}/${day}`, 'iYYYY/iM/iD');
            const gregorianFormatted = hijriDate.format('DD/MM/YYYY');
            const dayName = hijriDate.format('dddd');
            
            const resultBox = document.getElementById('gregorianResult');
            const dateElement = document.getElementById('gregorianDate');
            
            // Check if Thursday or Friday
            if (dayName === 'Thursday' || dayName === 'Friday') {
                resultBox.classList.add('weekend');
                dateElement.innerHTML = `${gregorianFormatted}<br>${dayName} <span class="weekend-badge">(WEEK END)</span>`;
            } else {
                resultBox.classList.remove('weekend');
                dateElement.innerHTML = `${gregorianFormatted}<br>${dayName}`;
            }
            
            resultBox.style.display = 'block';
        }
        
        // Universal copy value function
        function copyValue(elementId) {
            const value = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(value).then(() => {
                showToast('Copied: ' + value);
            });
        }
        
        // VAT Calculator
        function calculateVATFromIncluding() {
            const amount = parseFloat(document.getElementById('vatAmount').value);
            const result = document.getElementById('vatResult');
            
            // Clear the other input
            document.getElementById('vatAmountExcluding').value = '';
            
            if (!amount || amount <= 0) {
                result.style.display = 'none';
                return;
            }
            
            const withoutVat = (amount * 100) / 115;
            const vatOnly = amount - withoutVat;
            
            document.getElementById('vatWithout').textContent = withoutVat.toFixed(2);
            document.getElementById('vatWith').textContent = amount.toFixed(2);
            document.getElementById('vatOnly').textContent = vatOnly.toFixed(2);
            
            // Show only "Amount Without VAT" and "VAT Amount" (hide "Amount With VAT")
            document.getElementById('vatWithout').closest('.result-item').style.display = 'flex';
            document.getElementById('vatWith').closest('.result-item').style.display = 'none';
            document.getElementById('vatOnly').closest('.result-item').style.display = 'flex';
            
            result.style.display = 'block';
        }
        
        function calculateVATFromExcluding() {
            const amount = parseFloat(document.getElementById('vatAmountExcluding').value);
            const result = document.getElementById('vatResult');
            
            // Clear the other input
            document.getElementById('vatAmount').value = '';
            
            if (!amount || amount <= 0) {
                result.style.display = 'none';
                return;
            }
            
            const withVat = amount * 1.15;
            const vatOnly = withVat - amount;
            
            document.getElementById('vatWithout').textContent = amount.toFixed(2);
            document.getElementById('vatWith').textContent = withVat.toFixed(2);
            document.getElementById('vatOnly').textContent = vatOnly.toFixed(2);
            
            // Show only "Amount With VAT" and "VAT Amount" (hide "Amount Without VAT")
            document.getElementById('vatWithout').closest('.result-item').style.display = 'none';
            document.getElementById('vatWith').closest('.result-item').style.display = 'flex';
            document.getElementById('vatOnly').closest('.result-item').style.display = 'flex';
            
            result.style.display = 'block';
        }
        
        // Keep old function for backward compatibility
        function calculateVAT() {
            calculateVATFromIncluding();
        }
        
        // Meals Calculator
        function calculateMeals() {
            const price = parseFloat(document.getElementById('mealPrice').value);
            const days = parseFloat(document.getElementById('mealDays').value);
            const result = document.getElementById('mealsResult');
            
            if (!price || !days || price <= 0 || days <= 0) {
                result.style.display = 'none';
                return;
            }
            
            const withVat = price * days;
            const withoutVat = (withVat * 100) / 115 + 0.01;
            
            document.getElementById('mealsWithVat').textContent = withVat.toFixed(2);
            document.getElementById('mealsWithoutVat').textContent = withoutVat.toFixed(2);
            result.style.display = 'block';
        }
        
        // Nights Calculator
        function calculateNights() {
            const checkIn = document.getElementById('checkInDate').value;
            const checkOut = document.getElementById('checkOutDate').value;
            
            if (!checkIn || !checkOut) {
                document.getElementById('nightsValue').textContent = '0';
                document.getElementById('weekdayValue').textContent = '0';
                document.getElementById('weekendValue').textContent = '0';
                return;
            }
            
            const checkInDate = new Date(checkIn);
            const checkOutDate = new Date(checkOut);
            
            // Calculate difference in milliseconds
            const diffTime = checkOutDate - checkInDate;
            
            // Convert to days
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            // Ensure it's not negative
            const nights = diffDays > 0 ? diffDays : 0;
            
            // Calculate weekday and weekend nights
            let weekdayNights = 0;
            let weekendNights = 0;
            
            if (nights > 0) {
                // Iterate through each night
                const currentDate = new Date(checkInDate);
                
                for (let i = 0; i < nights; i++) {
                    const dayOfWeek = currentDate.getDay();
                    
                    // Weekend is Thursday (4) and Friday (5)
                    // Weekday is Saturday (6), Sunday (0), Monday (1), Tuesday (2), Wednesday (3)
                    if (dayOfWeek === 4 || dayOfWeek === 5) {
                        weekendNights++;
                    } else {
                        weekdayNights++;
                    }
                    
                    // Move to next day
                    currentDate.setDate(currentDate.getDate() + 1);
                }
            }
            
            // Display results
            document.getElementById('nightsValue').textContent = nights;
            document.getElementById('weekdayValue').textContent = weekdayNights;
            document.getElementById('weekendValue').textContent = weekendNights;
        }
        
        // Business Calculator
        function calculateBusiness() {
            const cost = parseFloat(document.getElementById('businessCost').value) || 0;
            const sell = parseFloat(document.getElementById('businessSell').value) || 0;
            
            const profit = sell - cost;
            const profitElement = document.getElementById('businessProfit');
            
            profitElement.textContent = profit.toFixed(2);
            
            // Add visual feedback for profit/loss
            if (profit < 0) {
                profitElement.classList.add('negative');
                profitElement.classList.remove('positive');
            } else {
                profitElement.classList.add('positive');
                profitElement.classList.remove('negative');
            }
        }
        
        // Reservation Counter Functions
        function addReservationBox() {
            const container = document.getElementById('reservationBoxes');
            const div = document.createElement('div');
            div.className = 'reservation-item';
            div.style.cssText = 'display: flex; gap: 10px; margin-bottom: 10px; align-items: center;';
            div.innerHTML = `
                <input type="number" class="reservation-input" placeholder="0" oninput="calculateReservationTotal()" style="flex: 1; padding: 12px; border: 2px solid var(--border); border-radius: 10px; font-size: 1rem;">
                <button onclick="removeReservationBox(this)" style="background: var(--error); color: white; border: none; border-radius: 8px; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem;">✕</button>
            `;
            container.appendChild(div);
            calculateReservationTotal();
        }
        
        function removeReservationBox(btn) {
            const container = document.getElementById('reservationBoxes');
            if (container.children.length > 1) {
                btn.parentElement.remove();
                calculateReservationTotal();
            } else {
                showToast('Cannot remove the last box!');
            }
        }
        
        function calculateReservationTotal() {
            const inputs = document.querySelectorAll('.reservation-input');
            let total = 0;
            
            inputs.forEach(input => {
                const value = parseFloat(input.value) || 0;
                total += value;
            });
            
            document.getElementById('reservationTotal').textContent = total;
        }
        
        // Flat Rate Calculators
        function calculateFlatRate1() {
            const wdPrice = parseFloat(document.getElementById('wdPrice').value) || 0;
            const wdDays = parseFloat(document.getElementById('wdDays').value) || 0;
            const wePrice = parseFloat(document.getElementById('wePrice').value) || 0;
            const weDays = parseFloat(document.getElementById('weDays').value) || 0;
            
            const total = (wdPrice * wdDays) + (wePrice * weDays);
            const totalDays = wdDays + weDays;
            const flatRate = totalDays > 0 ? Math.round(total / totalDays) : 0;
            
            document.getElementById('flatRate1').textContent = flatRate;
        }
        
        function copyFlatRate1() {
            const value = document.getElementById('flatRate1').textContent;
            navigator.clipboard.writeText(value).then(() => {
                showToast('Flat rate copied: ' + value);
            });
        }
        
        function calculateFlatRate2() {
            const dayItems = document.querySelectorAll('#dailyPricesList .day-item');
            let total = 0;
            let count = 0;
            
            dayItems.forEach(item => {
                const price = parseFloat(item.querySelector('.day-price').value) || 0;
                if (price > 0) {
                    total += price;
                    count++;
                }
            });
            
            const flatRate = count > 0 ? Math.round(total / count) : 0;
            document.getElementById('flatRate2').textContent = flatRate;
        }
        
        function copyFlatRate2() {
            const value = document.getElementById('flatRate2').textContent;
            navigator.clipboard.writeText(value).then(() => {
                showToast('Flat rate copied: ' + value);
            });
        }
        
        
function addDayItem() {
    const list = document.getElementById('dailyPricesList');
    const lastItem = list.lastElementChild;
    const days = ["Saturday", "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];

    let nextDay = "Saturday";

    if (lastItem) {
        const lastSelect = lastItem.querySelector('.day-select');
        const currentIndex = days.indexOf(lastSelect.value);
        nextDay = days[(currentIndex + 1) % days.length];
    }

    const div = document.createElement('div');
    div.className = 'day-item';
    div.innerHTML = `
        <select class="day-select" onchange="updateDaySequence(this)">
            ${days.map(d => `<option value="${d}" ${d === nextDay ? 'selected' : ''}>${d}</option>`).join('')}
        </select>
        <input type="number" class="day-price" placeholder="Price" oninput="calculateFlatRate2()">
        <button class="remove-day-btn" onclick="removeDayItem(this)">✕</button>
    `;
    list.appendChild(div);
}

function updateDaySequence(changedSelect) {
    const days = ["Saturday", "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];
    const list = document.getElementById('dailyPricesList');
    const allItems = Array.from(list.querySelectorAll('.day-item'));
    const changedItem = changedSelect.closest('.day-item');
    const changedIndex = allItems.indexOf(changedItem);
    const selectedDay = changedSelect.value;
    const selectedDayIndex = days.indexOf(selectedDay);
    
    // Update previous items (going backwards)
    for (let i = changedIndex - 1; i >= 0; i--) {
        const prevSelect = allItems[i].querySelector('.day-select');
        const stepsBack = changedIndex - i;
        const prevDayIndex = (selectedDayIndex - stepsBack + 7) % 7;
        prevSelect.value = days[prevDayIndex];
    }
    
    // Update next items (going forwards)
    for (let i = changedIndex + 1; i < allItems.length; i++) {
        const nextSelect = allItems[i].querySelector('.day-select');
        const stepsForward = i - changedIndex;
        const nextDayIndex = (selectedDayIndex + stepsForward) % 7;
        nextSelect.value = days[nextDayIndex];
    }
}
function removeDayItem(btn) {
            const list = document.getElementById('dailyPricesList');
            if (list.children.length > 1) {
                btn.parentElement.remove();
                calculateFlatRate2();
            } else {
                showToast('Cannot remove the last day!');
            }
        }
        
        // Rooming List Functions
        function addRoomingRow() {
            const list = document.getElementById('roomingList');
            const newRow = document.createElement('div');
            newRow.className = 'rooming-row';
            newRow.innerHTML = `
                <input type="text" class="guest-name" placeholder="Guest Name">
                <input type="number" class="room-number" placeholder="Rooms" min="1">
                
<input list="roomTypes" class="room-type" placeholder="Room Type">
<datalist id="roomTypes">
  <option value="SGL"><option value="DBL"><option value="TRPL"><option value="QUAD">
  <option value="QUIENT"><option value="STUDIO">
  <option value="1B SUITE"><option value="2B SUITE"><option value="3B SUITE">
  <option value="ROYAL SUITE">
  <option value="1B APARTMENT"><option value="2B APARTMENT"><option value="3B APARTMENT">
</datalist>

<input list="mealTypes" class="meal-type" placeholder="Meal Type">
<datalist id="mealTypes">
  <option value="R.O"><option value="B.B"><option value="H.B"><option value="F.B">
</datalist>

<input list="viewTypes" class="view-type" placeholder="View Type">
<datalist id="viewTypes">
  <option value="C.V"><option value="N.V"><option value="K.V"><option value="H.V">
  <option value="PARTIAL K.V"><option value="PARTIAL H.V"><option value="PREMIER K.V">
</datalist>

                <button class="remove-day-btn" onclick="removeRoomingRow(this)">✕</button>
            `;
            list.appendChild(newRow);
        }
        
        function removeRoomingRow(btn) {
            const list = document.getElementById('roomingList');
            if (list.children.length > 1) {
                btn.parentElement.remove();
            } else {
                showToast('Cannot remove the last row!');
            }
        }
        
        function clearRoomingList() {
            if (confirm('Are you sure you want to clear all rooming data?')) {
                const list = document.getElementById('roomingList');
                list.innerHTML = `
                    <div class="rooming-row">
                        <input type="text" class="guest-name" placeholder="Guest Name">
                        <input type="number" class="room-number" placeholder="Rooms" min="1">
                        
<input list="roomTypes" class="room-type" placeholder="Room Type">
<datalist id="roomTypes">
  <option value="SGL"><option value="DBL"><option value="TRPL"><option value="QUAD">
  <option value="QUIENT"><option value="STUDIO">
  <option value="1B SUITE"><option value="2B SUITE"><option value="3B SUITE">
  <option value="ROYAL SUITE">
  <option value="1B APARTMENT"><option value="2B APARTMENT"><option value="3B APARTMENT">
</datalist>

<input list="mealTypes" class="meal-type" placeholder="Meal Type">
<datalist id="mealTypes">
  <option value="R.O"><option value="B.B"><option value="H.B"><option value="F.B">
</datalist>

<input list="viewTypes" class="view-type" placeholder="View Type">
<datalist id="viewTypes">
  <option value="C.V"><option value="N.V"><option value="K.V"><option value="H.V">
  <option value="PARTIAL K.V"><option value="PARTIAL H.V"><option value="PREMIER K.V">
</datalist>

                        <button class="remove-day-btn" onclick="removeRoomingRow(this)">✕</button>
                    </div>
                `;
                document.getElementById('roomingPreview').style.display = 'none';
                showToast('Rooming list cleared!');
            }
        }
        
        function generateRoomingPreview() {
            const rows = document.querySelectorAll('#roomingList .rooming-row');
            const tbody = document.getElementById('roomingTableBody');
            tbody.innerHTML = '';
            
            let hasData = false;
            
            rows.forEach(row => {
                const guestName = row.querySelector('.guest-name').value.trim();
                const rooms = row.querySelector('.room-number').value;
                const roomType = row.querySelector('.room-type').value;
                const mealType = row.querySelector('.meal-type').value;
                const viewType = row.querySelector('.view-type').value;
                
                if (guestName || rooms || roomType || mealType || viewType) {
                    hasData = true;
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${guestName}</td>
                        <td>${rooms}</td>
                        <td>${roomType}</td>
                        <td>${mealType}</td>
                        <td>${viewType}</td>
                    `;
                    tbody.appendChild(tr);
                }
            });
            
            if (!hasData) {
                showToast('Please fill in some data first!');
                return;
            }
            
            document.getElementById('roomingPreview').style.display = 'block';
            showToast('Preview generated!');
        }
        
        function saveRoomingAsImage() {
            const preview = document.getElementById('roomingPreview');
            if (preview.style.display === 'none') {
                showToast('Please generate preview first!');
                return;
            }
            
            html2canvas(preview).then(canvas => {
                canvas.toBlob(blob => {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `rooming_list_${new Date().toISOString().split('T')[0]}.png`;
                    a.click();
                    URL.revokeObjectURL(url);
                    showToast('Saved as image!');
                });
            });
        }
        
        function saveRoomingAsExcel() {
            const preview = document.getElementById('roomingPreview');
            if (preview.style.display === 'none') {
                showToast('Please generate preview first!');
                return;
            }
            
            const table = document.getElementById('roomingTable');
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.table_to_sheet(table);
            XLSX.utils.book_append_sheet(wb, ws, 'Rooming List');
            XLSX.writeFile(wb, `rooming_list_${new Date().toISOString().split('T')[0]}.xlsx`);
            showToast('Saved as Excel!');
        }
        
        // Extensions Functions
        function addExtensionRow() {
            const list = document.getElementById('extensionsList');
            const newRow = document.createElement('div');
            newRow.className = 'extensions-row';
            newRow.innerHTML = `
                <input type="text" class="ext-guest-name" placeholder="Guest Name">
                <input type="text" class="ext-old-hcn" placeholder="Old HCN">
                <input type="text" class="ext-new-hcn" placeholder="New HCN">
                <input type="date" class="ext-from">
                <input type="date" class="ext-to">
                <button class="remove-day-btn" onclick="removeExtensionRow(this)">✕</button>
            `;
            list.appendChild(newRow);
        }
        
        function removeExtensionRow(btn) {
            const list = document.getElementById('extensionsList');
            if (list.children.length > 1) {
                btn.parentElement.remove();
            } else {
                showToast('Cannot remove the last row!');
            }
        }
        
        function clearExtensionsList() {
            if (confirm('Are you sure you want to clear all extensions data?')) {
                const list = document.getElementById('extensionsList');
                list.innerHTML = `
                    <div class="extensions-row">
                        <input type="text" class="ext-guest-name" placeholder="Guest Name">
                        <input type="text" class="ext-old-hcn" placeholder="Old HCN">
                        <input type="text" class="ext-new-hcn" placeholder="New HCN">
                        <input type="date" class="ext-from">
                        <input type="date" class="ext-to">
                        <button class="remove-day-btn" onclick="removeExtensionRow(this)">✕</button>
                    </div>
                `;
                document.getElementById('extensionsPreview').style.display = 'none';
                showToast('Extensions cleared!');
            }
        }
        
        function generateExtensionsPreview() {
            const rows = document.querySelectorAll('#extensionsList .extensions-row');
            const tbody = document.getElementById('extensionsTableBody');
            tbody.innerHTML = '';
            
            let hasData = false;
            
            rows.forEach(row => {
                const guestName = row.querySelector('.ext-guest-name').value.trim();
                const oldHcn = row.querySelector('.ext-old-hcn').value;
                const newHcn = row.querySelector('.ext-new-hcn').value;
                const from = row.querySelector('.ext-from').value;
                const to = row.querySelector('.ext-to').value;
                
                if (guestName || oldHcn || newHcn || from || to) {
                    hasData = true;
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${guestName}</td>
                        <td>${oldHcn}</td>
                        <td>${newHcn}</td>
                        <td>${from}</td>
                        <td>${to}</td>
                    `;
                    tbody.appendChild(tr);
                }
            });
            
            if (!hasData) {
                showToast('Please fill in some data first!');
                return;
            }
            
            document.getElementById('extensionsPreview').style.display = 'block';
            showToast('Preview generated!');
        }
        
        function saveExtensionsAsImage() {
            const preview = document.getElementById('extensionsPreview');
            if (preview.style.display === 'none') {
                showToast('Please generate preview first!');
                return;
            }
            
            html2canvas(preview).then(canvas => {
                canvas.toBlob(blob => {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `extensions_${new Date().toISOString().split('T')[0]}.png`;
                    a.click();
                    URL.revokeObjectURL(url);
                    showToast('Saved as image!');
                });
            });
        }
        
        function saveExtensionsAsExcel() {
            const preview = document.getElementById('extensionsPreview');
            if (preview.style.display === 'none') {
                showToast('Please generate preview first!');
                return;
            }
            
            const table = document.getElementById('extensionsTable');
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.table_to_sheet(table);
            XLSX.utils.book_append_sheet(wb, ws, 'Extensions');
            XLSX.writeFile(wb, `extensions_${new Date().toISOString().split('T')[0]}.xlsx`);
            showToast('Saved as Excel!');
        }
        
        // Task Manager Functions
        let tasks = JSON.parse(localStorage.getItem('workSmartTasks')) || [];
        
        function renderTasks() {
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = '';
            
            tasks.forEach((task, index) => {
                const taskItem = document.createElement('div');
                taskItem.className = `task-item ${task.completed ? 'completed' : ''}`;
                taskItem.innerHTML = `
                    <div class="task-text">${task.text}</div>
                    <div class="task-actions">
                        <button class="task-btn complete" onclick="toggleTask(${index})">
                            ${task.completed ? '↩️' : '✓'}
                        </button>
                        <button class="task-btn delete" onclick="deleteTask(${index})">
                            🗑️
                        </button>
                    </div>
                `;
                taskList.appendChild(taskItem);
            });
            
            saveTasks();
        }
        
        function addTask() {
            const input = document.getElementById('taskInput');
            const taskText = input.value.trim();
            
            if (!taskText) return;
            
            tasks.unshift({
                text: taskText,
                completed: false,
                date: new Date().toISOString()
            });
            
            input.value = '';
            renderTasks();
            showToast('Task added!');
        }
        
        function toggleTask(index) {
            tasks[index].completed = !tasks[index].completed;
            renderTasks();
        }
        
        function deleteTask(index) {
            tasks.splice(index, 1);
            renderTasks();
            showToast('Task deleted!');
        }
        
        function clearCompletedTasks() {
            tasks = tasks.filter(task => !task.completed);
            renderTasks();
            showToast('Completed tasks cleared!');
        }
        
        function clearAllTasks() {
            if (confirm('Are you sure you want to delete all tasks?')) {
                tasks = [];
                renderTasks();
                showToast('All tasks cleared!');
            }
        }
        
        function saveTasks() {
            localStorage.setItem('workSmartTasks', JSON.stringify(tasks));
        }
        
        function saveTasksManually() {
            saveTasks();
            showToast('Tasks saved successfully!');
        }
        
        function exportTasks() {
            if (tasks.length === 0) {
                showToast('No tasks to export!');
                return;
            }
            
            let text = '=== MY TASKS ===\n\n';
            
            const pendingTasks = tasks.filter(t => !t.completed);
            const completedTasks = tasks.filter(t => t.completed);
            
            if (pendingTasks.length > 0) {
                text += '📋 PENDING TASKS:\n';
                pendingTasks.forEach((task, index) => {
                    text += `${index + 1}. ☐ ${task.text}\n`;
                });
                text += '\n';
            }
            
            if (completedTasks.length > 0) {
                text += '✅ COMPLETED TASKS:\n';
                completedTasks.forEach((task, index) => {
                    text += `${index + 1}. ☑ ${task.text}\n`;
                });
            }
            
            text += `\n---\nTotal: ${tasks.length} tasks\nCompleted: ${completedTasks.length}\nPending: ${pendingTasks.length}\n`;
            text += `Exported on: ${new Date().toLocaleString()}\n`;
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `tasks_${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            showToast('Tasks exported!');
        }
        
        // Notes Functions
        let notes = localStorage.getItem('workSmartNotes') || '';
        
        function loadNotes() {
            const notesArea = document.getElementById('notesArea');
            notesArea.value = notes;
            updateNotesCount();
        }
        
        function updateNotesCount() {
            const notesArea = document.getElementById('notesArea');
            const count = notesArea.value.length;
            document.getElementById('notesCount').textContent = `${count} characters`;
        }
        
        function saveNotes() {
            const notesArea = document.getElementById('notesArea');
            notes = notesArea.value;
            localStorage.setItem('workSmartNotes', notes);
            showToast('Notes saved!');
        }
        
        function exportNotes() {
            const notesArea = document.getElementById('notesArea');
            const text = notesArea.value;
            
            if (!text.trim()) {
                showToast('No notes to export!');
                return;
            }
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `notes_${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            showToast('Notes exported!');
        }
        
        function clearNotes() {
            if (confirm('Are you sure you want to clear all notes?')) {
                document.getElementById('notesArea').value = '';
                notes = '';
                localStorage.removeItem('workSmartNotes');
                updateNotesCount();
                showToast('Notes cleared!');
            }
        }
        
        // Toast Notification
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
        
        // Initialize on load
        window.addEventListener('load', () => {
            renderTasks();
            loadNotes();
        });
        
        // Add Enter key support for adding tasks
        document.addEventListener('DOMContentLoaded', () => {
            const taskInput = document.getElementById('taskInput');
            if (taskInput) {
                taskInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        addTask();
                    }
                });
            }
        });
    
// ===== Date Converter Enhancements =====
let dateDebounceTimer = null;

function autoConvertDate() {
    clearTimeout(dateDebounceTimer);
    dateDebounceTimer = setTimeout(() => {
        convertDateSmart();
    }, 400);
}

function convertDateSmart() {
    const inputEl = document.getElementById('dateInput');
    const errorEl = document.getElementById('dateError');
    if (!inputEl) return;

    const value = inputEl.value.trim();
    if (!value) {
        if (errorEl) errorEl.textContent = '';
        return;
    }

    let year, month, day;

    // YYYY-MM-DD
    if (/^\d{4}-\d{2}-\d{2}$/.test(value)) {
        [year, month, day] = value.split('-').map(Number);
    }
    // DD/MM/YYYY
    else if (/^\d{2}\/\d{2}\/\d{4}$/.test(value)) {
        [day, month, year] = value.split('/').map(Number);
    } else {
        showDateError('Invalid format. Use DD/MM/YYYY or YYYY-MM-DD');
        return;
    }

    const date = new Date(year, month - 1, day);

    if (
        date.getFullYear() !== year ||
        date.getMonth() !== month - 1 ||
        date.getDate() !== day
    ) {
        showDateError('Invalid date');
        return;
    }

    clearDateError();
    convertDate(date);
}

function showDateError(msg) {
    let errorEl = document.getElementById('dateError');
    if (!errorEl) {
        errorEl = document.createElement('div');
        errorEl.id = 'dateError';
        errorEl.style.color = '#e74c3c';
        errorEl.style.marginTop = '6px';
        document.getElementById('dateInput').after(errorEl);
    }
    errorEl.textContent = msg;
}

function clearDateError() {
    const errorEl = document.getElementById('dateError');
    if (errorEl) errorEl.textContent = '';
}
// ===== END Date Converter Enhancements =====

</script>

<!-- ===================== EXTRACTOR DATA PRO ADDONS ===================== -->
<script>
/* ===== OCR MODES ===== */
let ocrMode = "standard";

function setOCRMode(mode){
  ocrMode = mode;
  // Update active tab button
  ['standard','passport','rooming'].forEach(m => {
    const btn = document.getElementById('modeBtn_' + m);
    if(btn) btn.classList.toggle('ocr-mode-active', m === mode);
  });
  showOCRStatus("Mode: " + mode.toUpperCase(), "#3498db");
}

/* ===== DRAG & DROP ===== */
function handleDrop(e){
  e.preventDefault();
  document.getElementById('dropZone').classList.remove('drop-zone-hover');
  const files = e.dataTransfer.files;
  if(!files.length) return;
  const input = document.getElementById('ocrImage');
  // Transfer files to the input
  const dt = new DataTransfer();
  for(const f of files) dt.items.add(f);
  input.files = dt.files;
  runBatchOCR();
}

/* ===== CHAR COUNT ===== */
function updateCharCount(){
  const ta = document.getElementById('ocrResult');
  const count = ta ? ta.value.length : 0;
  const el = document.getElementById('charCount');
  if(el) el.textContent = count.toLocaleString() + ' chars';
}

/* ===== COPY RESULT ===== */
function copyOCRResult(){
  const ta = document.getElementById('ocrResult');
  if(!ta || !ta.value.trim()){ showOCRStatus("Nothing to copy!", "#e74c3c"); return; }
  navigator.clipboard.writeText(ta.value).then(()=>{
    showOCRStatus("✅ Copied to clipboard!", "#27ae60");
  }).catch(()=>{
    ta.select();
    document.execCommand('copy');
    showOCRStatus("✅ Copied!", "#27ae60");
  });
}

/* ===== CLEAR RESULT ===== */
function clearOCRResult(){
  const ta = document.getElementById('ocrResult');
  if(ta){ ta.value = ''; updateCharCount(); }
  document.getElementById('filePreviewList').style.display = 'none';
  document.getElementById('filePreviewList').innerHTML = '';
  showOCRStatus("Cleared.", "#888");
}

/* ===== OCR STATUS ===== */
function showOCRStatus(msg, color){
  const el = document.getElementById('ocrStatus');
  if(!el) return;
  el.textContent = msg;
  el.style.background = color + '18';
  el.style.color = color;
  el.style.border = '1px solid ' + color + '44';
  el.style.display = 'block';
  clearTimeout(el._timer);
  el._timer = setTimeout(()=>{ el.style.display='none'; }, 3000);
}

/* ===== PROGRESS BAR ===== */
function setProgress(pct, label){
  const wrap = document.getElementById('ocrProgressWrap');
  const bar = document.getElementById('ocrProgressBar');
  const lbl = document.getElementById('ocrProgressLabel');
  if(!wrap) return;
  if(pct >= 100){ setTimeout(()=>{ wrap.style.display='none'; bar.style.width='0%'; }, 600); }
  else { wrap.style.display='block'; }
  bar.style.width = pct + '%';
  if(lbl && label) lbl.textContent = label;
}

/* ===== FILE PREVIEW ===== */
function showFilePreview(files){
  const el = document.getElementById('filePreviewList');
  if(!el || !files.length){ el.style.display='none'; return; }
  el.innerHTML = Array.from(files).map(f =>
    `<span style="display:inline-block;background:#ebf5fb;border:1px solid #aed6f1;border-radius:6px;padding:3px 10px;margin:3px;">📄 ${f.name} <span style="color:#aaa;">(${(f.size/1024).toFixed(1)} KB)</span></span>`
  ).join('');
  el.style.display = 'block';
}

/* ===== PDF OCR ===== */
async function runPdfOCR(file){
  const reader = new FileReader();
  reader.onload = async function(){
    const typedarray = new Uint8Array(this.result);
    const pdf = await pdfjsLib.getDocument(typedarray).promise;
    let fullText = "";
    for(let i=1;i<=pdf.numPages;i++){
      setProgress(Math.round((i/pdf.numPages)*90), `Reading PDF page ${i} of ${pdf.numPages}...`);
      const page = await pdf.getPage(i);
      const viewport = page.getViewport({scale:2});
      const canvas = document.createElement("canvas");
      const ctx = canvas.getContext("2d");
      canvas.height = viewport.height;
      canvas.width = viewport.width;
      await page.render({canvasContext:ctx, viewport}).promise;
      const { data:{ text } } = await Tesseract.recognize(canvas, "ara+eng");
      fullText += text + "\n";
    }
    setProgress(100, "Done!");
    postProcessOCR(fullText);
  };
  reader.readAsArrayBuffer(file);
}

/* ===== AI CLEANUP ===== */
function aiCleanup(text){
  return text
    .replace(/[^\w\s\u0600-\u06FF\/\-]/g,"")
    .replace(/\s{2,}/g," ")
    .replace(/\n{2,}/g,"\n")
    .trim();
}

/* ===== PASSPORT / ID OCR ===== */
function passportParser(text){
  const passport = {};
  const lines = text.split("\n");
  lines.forEach(l=>{
    if(/passport/i.test(l)) passport.type="PASSPORT";
    if(/name/i.test(l)) passport.name=l.split(":").pop().trim();
    if(/nationality/i.test(l)) passport.nationality=l.split(":").pop().trim();
    if(/date of birth|dob/i.test(l)) passport.dob=l.split(":").pop().trim();
    if(/passport no|number/i.test(l)) passport.number=l.split(":").pop().trim();
  });
  return Object.entries(passport).map(([k,v])=>k.toUpperCase()+": "+v).join("\n");
}

/* ===== AUTO ROOM TYPE DETECTION ===== */
function detectRoomType(nameLine){
  const n = nameLine.toUpperCase();
  if(n.includes("SGL") || n.includes("SINGLE")) return "SGL";
  if(n.includes("DBL") || n.includes("DOUBLE")) return "DBL";
  if(n.includes("TRPL") || n.includes("TRIPLE")) return "TRPL";
  if(n.includes("SUITE")) return "SUITE";
  return "";
}

/* ===== POST PROCESS ===== */
function postProcessOCR(rawText){
  let text = aiCleanup(rawText);
  if(ocrMode==="passport"){ text = passportParser(text); }
  document.getElementById("ocrResult").value = text;
  updateCharCount();
  detectArabic(text);
  const lines = text.split("\n").filter(l=>l.trim()).length;
  showOCRStatus(`✅ Done! ${lines} lines extracted.`, "#27ae60");
}

/* ===== OVERRIDE BATCH OCR ===== */
async function runBatchOCR(){
  const files = document.getElementById("ocrImage").files;
  if(!files.length) return;
  showFilePreview(files);
  let output = "";
  for(let i=0;i<files.length;i++){
    const f = files[i];
    setProgress(Math.round((i/files.length)*80), `Processing file ${i+1} of ${files.length}: ${f.name}`);
    if(f.type==="application/pdf"){
      await runPdfOCR(f);
      return;
    } else {
      const { data:{ text } } = await Tesseract.recognize(f,"ara+eng");
      output += text + "\n";
    }
  }
  setProgress(100, "Done!");
  postProcessOCR(output);
}

/* ===== SEND TO ROOMING WITH AUTO TYPE ===== */
function sendToRooming(){
  const text = document.getElementById("ocrResult").value;
  const names = text.split("\n").filter(l=>l.trim());
  const container = document.getElementById("roomingList");
  container.innerHTML="";
  names.forEach(line=>{
    const roomType = detectRoomType(line);
    const cleanName = line.replace(/SGL|DBL|TRPL|DOUBLE|SINGLE|SUITE/gi,"").trim();
    const row=document.createElement("div");
    row.className="rooming-row";
    row.innerHTML=`
      <input type="text" class="guest-name" value="${cleanName}">
      <input type="number" class="room-number" placeholder="Rooms">
      <input list="roomTypes" class="room-type" value="${roomType}">
      <input list="mealTypes" class="meal-type">
      <input list="viewTypes" class="view-type">
      <button class="remove-day-btn" onclick="removeRoomingRow(this)">✕</button>
    `;
    container.appendChild(row);
  });
  showToast("Rooming list generated!");
  window.scrollTo({top:container.offsetTop,behavior:"smooth"});
}
</script>

<!-- PDF.JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>


<!-- ===================== EXTRACTOR DATA ULTIMATE ADDONS ===================== -->
<script>
/* ===== LANGUAGE AUTO DETECTION ===== */
function detectLanguage(text){
  if(/[\u0600-\u06FF]/.test(text)) return "ara";
  return "eng";
}

/* ===== MRZ PASSPORT READER (ICAO) ===== */
function parseMRZ(text){
  const lines = text.split("\n").filter(l=>l.includes("<"));
  if(lines.length < 2) return text;

  const l1 = lines[0];
  const l2 = lines[1];

  const passport = {
    type: l1.substring(0,2).replace(/</g,""),
    country: l1.substring(2,5).replace(/</g,""),
    name: l1.substring(5).replace(/</g," ").trim(),
    passportNumber: l2.substring(0,9).replace(/</g,""),
    nationality: l2.substring(10,13).replace(/</g,""),
    dob: l2.substring(13,19),
    gender: l2.substring(20,21),
    expiry: l2.substring(21,27)
  };

  return `PASSPORT (MRZ)
NAME: ${passport.name}
PASSPORT NO: ${passport.passportNumber}
NATIONALITY: ${passport.nationality}
DOB: ${passport.dob}
GENDER: ${passport.gender}
EXPIRY: ${passport.expiry}`;
}

/* ===== AI NAME CORRECTION (LIGHT MODEL) ===== */
function aiNameFix(name){
  return name
    .replace(/0/g,"O")
    .replace(/1/g,"I")
    .replace(/5/g,"S")
    .replace(/8/g,"B")
    .replace(/\s{2,}/g," ")
    .replace(/[^A-Za-z\u0600-\u06FF\s]/g,"")
    .trim();
}

/* ===== AUTO MEAL PLAN DETECTION ===== */
function detectMealPlan(line){
  const l = line.toUpperCase();
  if(l.includes("BB")) return "BB";
  if(l.includes("HB")) return "HB";
  if(l.includes("FB")) return "FB";
  if(l.includes("AI") || l.includes("ALL")) return "AI";
  return "";
}

/* ===== OVERRIDE POST PROCESS ===== */
function postProcessOCR(rawText){
  let text = aiCleanup(rawText);

  // MRZ detection
  if(text.includes("<<")){
    text = parseMRZ(text);
  }

  document.getElementById("ocrResult").value = text;
  detectArabic(text);
}

/* ===== ROOMING → EXCEL (FORMATTED) ===== */
function exportRoomingExcel(){
  const rows = document.querySelectorAll(".rooming-row");
  const data = [["Guest Name","Rooms","Room Type","Meal Plan","View"]];

  rows.forEach(r=>{
    const inputs = r.querySelectorAll("input");
    data.push([
      inputs[0].value,
      inputs[1].value,
      inputs[2].value,
      inputs[3].value,
      inputs[4].value
    ]);
  });

  const ws = XLSX.utils.aoa_to_sheet(data);
  ws["!cols"] = [{wpx:200},{wpx:80},{wpx:100},{wpx:100},{wpx:100}];
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "Rooming List");
  XLSX.writeFile(wb, "Rooming_List.xlsx");
}

/* ===== SEND TO ROOMING (SMART) ===== */
function sendToRooming(){
  const text = document.getElementById("ocrResult").value;
  const lines = text.split("\n").filter(l=>l.trim());
  const container = document.getElementById("roomingList");
  container.innerHTML="";

  lines.forEach(line=>{
    const roomType = detectRoomType(line);
    const meal = detectMealPlan(line);
    // Additional logic would go here
  });
}
</script>

<!-- ===== EXTRACTOR DATA ADVANCED UPGRADE (NON-DESTRUCTIVE) ===== -->
<script>
// ===== ML Document Classification =====
function mlClassify(text){
  const s={passport:0,visa:0,id:0,rooming:0};
  if(/P<[A-Z]{3}/.test(text)) s.passport+=6;
  if(/VISA|ENTRY|VALID/i.test(text)) s.visa+=5;
  if(/IDENTITY|ID CARD|NATIONAL/i.test(text)) s.id+=5;
  if(text.split('\n').length>12) s.rooming+=3;
  return Object.keys(s).reduce((a,b)=>s[a]>s[b]?a:b);
}

// ===== Passport / Visa / ID Extractors =====
function extractPassportFields(text){
  return {
    name:(text.match(/P<.{3}([A-Z<]+)/)||['',''])[1].replace(/</g,' ').trim(),
    nationality:(text.match(/P<([A-Z]{3})/)||['',''])[1],
    dob:(text.match(/\d{2}[A-Z]{3}\d{2}/)||[''])[0]
  };
}

function extractVisaFields(text){
  return {
    visaNumber:text.match(/VISA\s*NO\.?\s*(\w+)/i)?.[1]||'',
    validUntil:text.match(/VALID\s*UNTIL\s*(\d{2}\/\d{2}\/\d{4})/i)?.[1]||''
  };
}
</script>
<script>
// Email Forms Data
const emailForms = [
    {
        title: "STAY REQUEST طلب إستاي",
        subject: "Stay Report Request (DATE + MONTH EX: 01 JANUARY)",
        body: `Dear Reservations Team,
Kindly send the stay report for 01 January.
Thanks And Best Regards,`
    },
    {
        title: "ARRIVAL REQUEST طلب أرايفل",
        subject: "Arrival Report Request",
        body: `Dear Reservations Team,
Kindly send the arrival report included block and overblock if there is.
Thanks And Best Regards,`
    },
    {
        title: "NEW BOOKING حجز جديد",
        subject: "New Booking : (RESERVATION NUMBER)",
        body: `Dear Reservations Team,
Kindly confirm the attached booking under our (allotment block/Deposit/AR/Cash payment).
Thanks And Best Regards,`
    },
    {
        title: "CANCEL REQUEST إلغاء حجز",
        subject: "Cancellation Request : (RESERVATION NUMBER)",
        body: `Dear Reservations Team,
Kindly proceed with the cancellation of HCN (******).
Thanks And Best Regards,`
    },
    {
        title: "AMENDMENT REQUEST طلب تعديل حجز",
        subject: "Amendment Request : (RESERVATION NUMBER)",
        body: `Dear Reservations Team,
Kindly amend HCN (******) as per the below details:
Guest Name: (******) 
Room Type: (******) 
Meal Type: (******) 
View Type: (******) 
Thanks And Best Regards,`
    },
    {
        title: "CHECK AVAILABILITY تشييك إمكانية",
        subject: "Check Availability: (Guest Name)",
        body: `Dear Reservations Team,
Please check the availability for the booking details below:
Guest Name: (******) 
Arrival: **/**/2026 
Departure: **/**/2026 
Room Type: 01 DBL C.V  
Meal Plan: B.B
Thanks And Best Regards,`
    },
    {
        title: "New Booking (Option Date) حجز او تشييك أوبشن ديت",
        subject: "New Booking (Option Date): (Guest Name)",
        body: `Dear Reservations Team,
Please check the availability for the booking details below:
Guest Name: (******) 
Arrival: **/**/2026 
Departure: **/**/2026 
Room Type: 01 DBL C.V  
Meal Plan: B.B
Thanks And Best Regards,`
    },
    {
        title: "Add Guest Name إضافة أسماء نزلاء",
        subject: "Add Guest Name : (RESERVATION NUMBER)",
        body: `Dear Reservations Team,
Kindly Add Guest Name To HCN: (******) According to (The Attachment / As below)
Thanks And Best Regards,`
    },
    {
        title: "STOP SALE REQUEST طلب تقرير استوب سيل",
        subject: "STOP SALE REQUEST",
        body: `Dear Reservations Team,
Kindly send the stop sale report.
Thanks And Best Regards,`
    },
    {
        title: "Nusuk Approval طلب موافقة نسك",
        subject: "Nusuk Approval : (RESERVATION NUMBER)",
        body: `Dear Reservations Team,
Kindly approve the attached Nusuk request No. (********) for HCN (********).
Thanks And Best Regards,`
    },
    {
        title: "Group Source Request طلب ربط سورس لحجز",
        subject: "Group Source Request : (RESERVATION NUMBER)",
        body: `Dear Reservations Team,
Kindly create a group source (******) for the attached rooming list.
Thanks And Best Regards,`
    }
];

// Initialize Email Forms
function initEmailForms() {
    const container = document.getElementById('emailFormsContainer');
    if (!container) return;
    
    emailForms.forEach((form, index) => {
        const formDiv = document.createElement('div');
        formDiv.className = 'email-form';
        
        // Create header
        const header = document.createElement('div');
        header.className = 'form-header';
        header.onclick = function() { toggleEmailForm(index); };
        header.innerHTML = '<span>' + form.title + '</span><span id="formArrow' + index + '">▼</span>';
        
        // Create content
        const content = document.createElement('div');
        content.className = 'form-content';
        content.id = 'formContent' + index;
        
        // Create body
        const body = document.createElement('div');
        body.className = 'form-body';
        
        // Subject field
        const subjectField = document.createElement('div');
        subjectField.className = 'form-field';
        subjectField.innerHTML = '<label>SUBJECT:</label><div class="value">' + form.subject + '</div>';
        
        // Body field
        const bodyField = document.createElement('div');
        bodyField.className = 'form-field';
        const bodyLabel = document.createElement('label');
        bodyLabel.textContent = 'EMAIL BODY:';
        const bodyValue = document.createElement('div');
        bodyValue.className = 'value';
        bodyValue.textContent = form.body;
        bodyField.appendChild(bodyLabel);
        bodyField.appendChild(bodyValue);
        
        // Copy button
        const copyBtn = document.createElement('button');
        copyBtn.className = 'btn btn-success';
        copyBtn.onclick = function() { copyEmailForm(index); };
        copyBtn.innerHTML = '<span>📋</span><span>Copy Email</span>';
        
        // Assemble
        body.appendChild(subjectField);
        body.appendChild(bodyField);
        body.appendChild(copyBtn);
        content.appendChild(body);
        formDiv.appendChild(header);
        formDiv.appendChild(content);
        container.appendChild(formDiv);
    });
}

function toggleEmailForm(index) {
    const content = document.getElementById('formContent' + index);
    const arrow = document.getElementById('formArrow' + index);
    
    if (content && arrow) {
        if (content.classList.contains('open')) {
            content.classList.remove('open');
            arrow.textContent = '▼';
            arrow.style.transform = 'rotate(0deg)';
        } else {
            // Close all other forms
            document.querySelectorAll('.form-content').forEach(c => c.classList.remove('open'));
            document.querySelectorAll('[id^="formArrow"]').forEach(a => {
                a.textContent = '▼';
                a.style.transform = 'rotate(0deg)';
            });
            
            content.classList.add('open');
            arrow.textContent = '▲';
            arrow.style.transform = 'rotate(180deg)';
        }
    }
}

function copyEmailForm(index) {
    const form = emailForms[index];
    const text = 'Subject: ' + form.subject + '\n\n' + form.body;
    
    navigator.clipboard.writeText(text).then(() => {
        if (typeof showToast === 'function') {
            showToast('Email copied to clipboard!');
        } else {
            alert('Email copied to clipboard!');
        }    }).catch(err => {
        console.error('Failed to copy:', err);
    });
}
</script>

<script>
// Smooth scroll for navigation links
document.addEventListener('DOMContentLoaded', function() {
    // Add smooth scroll behavior
    document.querySelectorAll('.nav-link').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetElement = document.getElementById(targetId);
            
            if (targetElement) {
                const targetPosition = targetElement.offsetTop - 20;
                
                window.scrollTo({
                    top: targetPosition,
                    behavior: 'smooth'
                });
            }
        });
    });
    
    // Initialize Email Forms
    if (typeof initEmailForms === 'function') {
        initEmailForms();
    }
});
</script>

</body>
</html>
